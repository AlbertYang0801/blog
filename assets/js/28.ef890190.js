(window.webpackJsonp=window.webpackJsonp||[]).push([[28],{340:function(s,a,t){"use strict";t.r(a);var e=t(18),r=Object(e.a)({},(function(){var s=this,a=s._self._c;return a("ContentSlotsDistributor",{attrs:{"slot-key":s.$parent.slotKey}},[a("h1",{attrs:{id:"mysql的binlog日志过期删除"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#mysql的binlog日志过期删除"}},[s._v("#")]),s._v(" MySQL的binlog日志过期删除")]),s._v(" "),a("h3",{attrs:{id:"问题"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#问题"}},[s._v("#")]),s._v(" 问题")]),s._v(" "),a("p",[s._v("mysql的binlog日志过多导致磁盘告警。")]),s._v(" "),a("p",[s._v("部署脚本中没有配置 "),a("code",[s._v("binlog")]),s._v(" 的失效时间，默认是30天。")]),s._v(" "),a("h2",{attrs:{id:"手动清理"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#手动清理"}},[s._v("#")]),s._v(" 手动清理")]),s._v(" "),a("ol",[a("li",[a("p",[s._v("查看正在使用的binlog")]),s._v(" "),a("div",{staticClass:"language-sql line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-sql"}},[a("code",[a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("show")]),s._v(" master "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("status")]),s._v("\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br")])])]),s._v(" "),a("li",[a("p",[s._v("删除指定binlog之前的所有binlog")]),s._v(" "),a("div",{staticClass:"language-sql line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-sql"}},[a("code",[a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("purge")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("binary")]),s._v(" logs "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("to")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("'bin.000055'")]),s._v("\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br")])])])]),s._v(" "),a("h2",{attrs:{id:"配置自动清理"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#配置自动清理"}},[s._v("#")]),s._v(" 配置自动清理")]),s._v(" "),a("h3",{attrs:{id:"查看日志过期时间"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#查看日志过期时间"}},[s._v("#")]),s._v(" 查看日志过期时间")]),s._v(" "),a("div",{staticClass:"language-sql line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-sql"}},[a("code",[a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("show")]),s._v(" variables "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("like")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("'%expire_logs%'")]),s._v("\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br")])]),a("table",[a("thead",[a("tr",[a("th",[s._v("Variable")]),s._v(" "),a("th",[s._v("Value")])])]),s._v(" "),a("tbody",[a("tr",[a("td",[s._v("binlog_expire_logs_seconds")]),s._v(" "),a("td",[s._v("2592000")])]),s._v(" "),a("tr",[a("td",[s._v("expire_logs_days")]),s._v(" "),a("td",[s._v("0")])])])]),s._v(" "),a("ul",[a("li",[a("p",[a("code",[s._v("binlog_expire_logs_seconds")])]),s._v(" "),a("p",[s._v("8.x 版本之后支持该参数，单位秒。")])]),s._v(" "),a("li",[a("p",[a("code",[s._v("expire_logs_days")])]),s._v(" "),a("p",[s._v("单位天。")])])]),s._v(" "),a("h3",{attrs:{id:"修改my-cnf-配置文件"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#修改my-cnf-配置文件"}},[s._v("#")]),s._v(" 修改my.cnf 配置文件")]),s._v(" "),a("ul",[a("li",[a("p",[s._v("8.x版本")]),s._v(" "),a("p",[a("code",[s._v("Plain Text binlog_expire_logs_seconds=172800")])]),s._v(" "),a("p",[a("img",{attrs:{src:"MySQL196bbc88-98a3-499e-92b0-6d46f8281658MySQL%E7%9A%84binlog%E6%97%A5%E5%BF%97%E8%BF%87%E6%9C%9F%E5%88%A0%E9%99%A445d93d08-f357-4190-a1b3-946833785c69image_kc5D4GQ789..png",alt:""}})])])]),s._v(" "),a("h3",{attrs:{id:"重启mysql服务"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#重启mysql服务"}},[s._v("#")]),s._v(" 重启MySQL服务")]),s._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v("systemctl restart mysqld\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br")])]),a("h2",{attrs:{id:"参考链接"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#参考链接"}},[s._v("#")]),s._v(" 参考链接")]),s._v(" "),a("p",[a("a",{attrs:{href:"http://t.zoukankan.com/jimoliunian-p-13896409.html",target:"_blank",rel:"noopener noreferrer"}},[s._v("Mysql设置binlog过期时间并自动删除 - 走看看"),a("OutboundLink")],1)])])}),[],!1,null,null,null);a.default=r.exports}}]);