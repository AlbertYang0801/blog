(window.webpackJsonp=window.webpackJsonp||[]).push([[95],{451:function(s,t,a){"use strict";a.r(t);var n=a(26),r=Object(n.a)({},(function(){var s=this,t=s.$createElement,a=s._self._c||t;return a("ContentSlotsDistributor",{attrs:{"slot-key":s.$parent.slotKey}},[a("h1",{attrs:{id:"基础概念"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#基础概念"}},[s._v("#")]),s._v(" 基础概念")]),s._v(" "),a("h2",{attrs:{id:"一、索引库-index"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#一、索引库-index"}},[s._v("#")]),s._v(" 一、索引库（index）")]),s._v(" "),a("p",[s._v("Elasticsearch的索引库是一个逻辑上的概念，存储了相同类型的文档内容。类似于 MySQL 数据表，MongoDB 中的集合。")]),s._v(" "),a("ol",[a("li",[a("p",[s._v("新建索引库")]),s._v(" "),a("ul",[a("li",[a("p",[s._v("number_of_shards")]),s._v(" "),a("p",[s._v("设置分片的数量，在集群中通常设置多个分片，表示一个索引库将拆分成多片分别存储不同 的结点，提高了ES的处理能力和高可用性，入门程序使用单机环境，这里设置为 1。")])]),s._v(" "),a("li",[a("p",[s._v("number_of_replicas")]),s._v(" "),a("p",[s._v("设置副本的数量，设置副本是为了提高ES的高可靠性，单机环境设置为 0。")])])])]),s._v(" "),a("li",[a("p",[s._v("新建测试")]),s._v(" "),a("p",[s._v("例如新建一个 order 索引库，5 个分片，无副本。")]),s._v(" "),a("div",{staticClass:"language-java line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-java"}},[a("code",[s._v("curl "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("--")]),s._v("location "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("--")]),s._v("request PUT "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("'http://localhost:9200/order/'")]),s._v(" \\\n"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("--")]),s._v("header "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("'Content-Type: application/json'")]),s._v(" \\\n"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("--")]),s._v("data"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v("raw '"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"settings"')]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n        "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"index"')]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n            "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"number_of_shards"')]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("5")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n            "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"number_of_replicas"')]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v("\n        "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("'\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br"),a("span",{staticClass:"line-number"},[s._v("9")]),a("br"),a("span",{staticClass:"line-number"},[s._v("10")]),a("br")])]),a("p",[a("img",{attrs:{src:"https://cdn.jsdelivr.net/gh/AlbertYang0801/pic-bed@main/img/20210628112620.png",alt:""}})])]),s._v(" "),a("li",[a("p",[s._v("索引含义区分")]),s._v(" "),a("ul",[a("li",[a("p",[s._v("索引（名词）")]),s._v(" "),a("p",[s._v("一个索引（index）对应一个索引库，就像是传统关系数据库 MySQL 中的数据库，是存储文档的地方。")])]),s._v(" "),a("li",[a("p",[s._v("索引（动词）")]),s._v(" "),a("p",[s._v("索引一个文档，代表将一个文档存储到索引库里，以便于文档被检索或者查询。")]),s._v(" "),a("p",[s._v("类似于 MySQL 中的 "),a("code",[s._v("INSERT")]),s._v("  插入数据，不同的是索引会将旧文档覆盖。")])]),s._v(" "),a("li",[a("p",[s._v("倒排索引")]),s._v(" "),a("p",[s._v("在传统数据库中为了提高查询效率，通常会为特定列增加索引来达到。")]),s._v(" "),a("p",[s._v("而在 Es 中采用了"),a("strong",[s._v("倒排索引")]),s._v("的数据结构来提高查询效率。")])])])])]),s._v(" "),a("h2",{attrs:{id:"二、类型-type"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#二、类型-type"}},[s._v("#")]),s._v(" 二、类型（_type)")]),s._v(" "),a("p",[s._v("映射的元数据字段中的"),a("code",[s._v("_type")]),s._v(" 字段。代表着索引的类型，每个文档中都会有"),a("code",[s._v("_type")]),s._v("字段信息进行区分文档。")]),s._v(" "),a("blockquote",[a("p",[s._v("Elasticse arch 官网提出的近期版本对 type 概念的演变情况如下：")]),s._v(" "),a("p",[s._v("在 5.X 版本中，一个 index 下可以创建多个 type；")]),s._v(" "),a("p",[s._v("在 6.X 版本中，一个 index 下只能存在一个 type；默认为 _doc；")]),s._v(" "),a("p",[s._v("在 7.X 版本中，直接去除了 type 的概念，就是说 index 不再会有 type。")])]),s._v(" "),a("p",[a("strong",[s._v("为什么ElasticSearch要在7.X版本去掉type?")])]),s._v(" "),a("blockquote",[a("p",[s._v("ES 最先的设计是用索引类比关系型数据库的数据库，用 "),a("code",[s._v("mapping type")]),s._v(" 来类比表，一个索引中可以包含多个映射类别。这个类比存在一个严重的问题，就是当多个mapping type中存在同名字段时（特别是同名字段还是不同类型的），在一个索引中不好处理，因为搜索引擎中只有 索引-文档的结构，不同映射类别的数据都是一个一个的文档（只是包含的字段不一样而已）")])]),s._v(" "),a("h2",{attrs:{id:"三、映射-mapping"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#三、映射-mapping"}},[s._v("#")]),s._v(" 三、映射（mapping）")]),s._v(" "),a("p",[s._v("映射定义索引中有什么字段、进行字段类型确认。类似于数据库中表结构定义。")]),s._v(" "),a("h3",{attrs:{id:"元字段"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#元字段"}},[s._v("#")]),s._v(" 元字段")]),s._v(" "),a("p",[s._v("每个文档都有与之关联的元数据，例如"),a("code",[s._v("_index")]),s._v("、"),a("code",[s._v("_type")]),s._v("和 "),a("code",[s._v("_id")]),s._v(" 等字段。创建映射类型时，可以自定义其中一些元数据字段的行为。")]),s._v(" "),a("table",[a("thead",[a("tr",[a("th",[s._v("元数据字段")]),s._v(" "),a("th",[s._v("含义")])])]),s._v(" "),a("tbody",[a("tr",[a("td",[s._v("_index")]),s._v(" "),a("td",[s._v("文档所属索引")])]),s._v(" "),a("tr",[a("td",[s._v("_type")]),s._v(" "),a("td",[s._v("文档映射类型（7.x 已废弃）")])]),s._v(" "),a("tr",[a("td",[s._v("_id")]),s._v(" "),a("td",[s._v("文档 ID")])]),s._v(" "),a("tr",[a("td",[s._v("_source")]),s._v(" "),a("td",[s._v("表示文档正文的原始 JSON")])])])]),s._v(" "),a("p",[a("a",{attrs:{href:"https://www.elastic.co/guide/en/elasticsearch/reference/current/mapping-fields.html",target:"_blank",rel:"noopener noreferrer"}},[s._v("Elasticsearch Guide [7.13]-Mapping-Metadata fields"),a("OutboundLink")],1)]),s._v(" "),a("h3",{attrs:{id:"映射方式"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#映射方式"}},[s._v("#")]),s._v(" 映射方式")]),s._v(" "),a("p",[s._v("ES 支持"),a("strong",[s._v("手动定义映射")]),s._v("和"),a("strong",[s._v("动态映射")]),s._v("两种映射方式。")]),s._v(" "),a("ol",[a("li",[a("p",[a("strong",[s._v("动态映射")])]),s._v(" "),a("p",[s._v("默认情况下，当在文档中找到以前未见过的字段时，Elasticsearch 会将新字段添加到类型映射中。"),a("a",{attrs:{href:"https://www.elastic.co/guide/en/elasticsearch/reference/6.8/object.html",target:"_blank",rel:"noopener noreferrer"}},[a("code",[s._v("object")]),a("OutboundLink")],1),s._v(" 通过将"),a("a",{attrs:{href:"https://www.elastic.co/guide/en/elasticsearch/reference/6.8/dynamic.html",target:"_blank",rel:"noopener noreferrer"}},[a("code",[s._v("dynamic")]),a("OutboundLink")],1),s._v("参数设置为"),a("code",[s._v("false")]),s._v("（忽略新字段）或设置为"),a("code",[s._v("strict")]),s._v("（在遇到未知字段时抛出异常），可以在文档和级别禁用此行为。（6.8 版本和 7.x 版本字段映射关系不同）。")]),s._v(" "),a("p",[s._v("6.8 版本字段映射关系截图：")]),s._v(" "),a("p",[a("img",{attrs:{src:"https://cdn.jsdelivr.net/gh/AlbertYang0801/pic-bed@main/img/20210630164041.png",alt:""}})]),s._v(" "),a("p",[s._v("参考："),a("a",{attrs:{href:"https://www.elastic.co/guide/en/elasticsearch/reference/6.8/dynamic-field-mapping.html",target:"_blank",rel:"noopener noreferrer"}},[s._v("Elasticsearch Guide [6.8]- Dynamic field mapping"),a("OutboundLink")],1)])]),s._v(" "),a("li",[a("p",[a("strong",[s._v("手动映射")])]),s._v(" "),a("p",[s._v("可以通过 RestAPI 请求手动指定索引的映射。")]),s._v(" "),a("div",{staticClass:"language-java line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-java"}},[a("code",[s._v("curl "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("--")]),s._v("location "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("--")]),s._v("request POST "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("'localhost:9200/course/_mapping'")]),s._v(" \\\n"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("--")]),s._v("header "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("'Content-Type: application/json'")]),s._v(" \\\n"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("--")]),s._v("data"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v("raw '"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"properties"')]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n        "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"name"')]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n            "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"type"')]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"text"')]),s._v("\n        "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n        "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"description"')]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n            "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"type"')]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"text"')]),s._v("\n        "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n        "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"studymodel"')]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n            "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"type"')]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"keyword"')]),s._v("\n        "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("'\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br"),a("span",{staticClass:"line-number"},[s._v("9")]),a("br"),a("span",{staticClass:"line-number"},[s._v("10")]),a("br"),a("span",{staticClass:"line-number"},[s._v("11")]),a("br"),a("span",{staticClass:"line-number"},[s._v("12")]),a("br"),a("span",{staticClass:"line-number"},[s._v("13")]),a("br"),a("span",{staticClass:"line-number"},[s._v("14")]),a("br"),a("span",{staticClass:"line-number"},[s._v("15")]),a("br")])])])]),s._v(" "),a("h3",{attrs:{id:"常用-api"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#常用-api"}},[s._v("#")]),s._v(" 常用 API")]),s._v(" "),a("ol",[a("li",[a("p",[s._v("索引映射")]),s._v(" "),a("div",{staticClass:"language-java line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-java"}},[a("code",[a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("//查看所有映射")]),s._v("\ncurl "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("--")]),s._v("location "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("--")]),s._v("request GET "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("'http://localhost:9200/_mapping'")]),s._v("\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("//查看指定索引的映射")]),s._v("\ncurl "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("--")]),s._v("location "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("--")]),s._v("request GET "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("'localhost:9200/{索引}/_mapping'")]),s._v("\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br")])])]),s._v(" "),a("li",[a("p",[s._v("创建映射")]),s._v(" "),a("div",{staticClass:"language-java line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-java"}},[a("code",[s._v("POST localhost"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("9200")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("索引名"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("_mapping\n\ncurl "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("--")]),s._v("location "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("--")]),s._v("request POST "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("'localhost:9200/course/_mapping'")]),s._v(" \\\n"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("--")]),s._v("header "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("'Content-Type: application/json'")]),s._v(" \\\n"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("--")]),s._v("data"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v("raw '"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"properties"')]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n        "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"name"')]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n            "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"type"')]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"text"')]),s._v("\n        "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n        "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"description"')]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n            "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"type"')]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"text"')]),s._v("\n        "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n        "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"price"')]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n            "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"type"')]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"long"')]),s._v("\n        "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("'\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br"),a("span",{staticClass:"line-number"},[s._v("9")]),a("br"),a("span",{staticClass:"line-number"},[s._v("10")]),a("br"),a("span",{staticClass:"line-number"},[s._v("11")]),a("br"),a("span",{staticClass:"line-number"},[s._v("12")]),a("br"),a("span",{staticClass:"line-number"},[s._v("13")]),a("br"),a("span",{staticClass:"line-number"},[s._v("14")]),a("br"),a("span",{staticClass:"line-number"},[s._v("15")]),a("br"),a("span",{staticClass:"line-number"},[s._v("16")]),a("br"),a("span",{staticClass:"line-number"},[s._v("17")]),a("br")])])]),s._v(" "),a("li",[a("p",[s._v("更新映射")]),s._v(" "),a("p",[s._v("映射创建成功之后，已有字段不允许更新，可以添加新字段。")])]),s._v(" "),a("li",[a("p",[s._v("删除映射")]),s._v(" "),a("p",[s._v("通过删除索引来删除映射。")])])]),s._v(" "),a("h2",{attrs:{id:"四、文档-documents"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#四、文档-documents"}},[s._v("#")]),s._v(" 四、文档（documents）")]),s._v(" "),a("p",[s._v("ES 是面向文档的，搜索和索引数据的最小单位是文档。官方文档基础介绍。")]),s._v(" "),a("blockquote",[a("p",[s._v("文档是可以被索引的基本信息单元。例如，您可以为单个客户创建一个文档，为单个产品创建另一个文档，以及为单个订单创建另一个文档。该文档以 JSON（JavaScript Object Notation）表示，这是一种普遍存在的互联网数据交换格式。")]),s._v(" "),a("p",[s._v("在索引/类型中，您可以存储任意数量的文档。请注意，尽管文档物理上位于索引中，但文档实际上必须被索引/分配给索引内的类型。")])]),s._v(" "),a("p",[a("strong",[s._v("ES 中的文档类似 MySQL 数据表中的记录")]),s._v("。")]),s._v(" "),a("p",[s._v("ES 可以存储数据复杂的数据，而且每个数据还存在索引，便于搜索文档内容。）（关系型数据库存储数据结构复杂的数据时，先要打散数据存入数据库，再取出的时候往往需要拼接数据）")]),s._v(" "),a("h3",{attrs:{id:"常用-api-2"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#常用-api-2"}},[s._v("#")]),s._v(" 常用 API")]),s._v(" "),a("ol",[a("li",[a("p",[s._v("创建文档")]),s._v(" "),a("p",[s._v("不指定Id的话，es 会自动创建 Id。")]),s._v(" "),a("div",{staticClass:"language-java line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-java"}},[a("code",[s._v("POST http"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("localhost"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("9200")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("索引名"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("_doc"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("id"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n\ncurl "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("--")]),s._v("location "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("--")]),s._v("request POST "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("'http://localhost:9200/course/_doc'")]),s._v(" \\\n"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("--")]),s._v("header "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("'Content-Type: application/json'")]),s._v(" \\\n"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("--")]),s._v("data"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v("raw '"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"name"')]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"Java进阶"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"price"')]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("120")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"description"')]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"Java yyds"')]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("'\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br"),a("span",{staticClass:"line-number"},[s._v("9")]),a("br")])])]),s._v(" "),a("li",[a("p",[s._v("更新文档")]),s._v(" "),a("div",{staticClass:"language-java line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-java"}},[a("code",[s._v("POST http"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("localhost"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("9200")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("索引名"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("_doc"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("文档"),a("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("Id")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n\ncurl "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("--")]),s._v("location "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("--")]),s._v("request POST "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("'http://localhost:9200/course/_doc/q_PQW3oBBs5dY209hPKx'")]),s._v(" \\\n"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("--")]),s._v("header "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("'Content-Type: application/json'")]),s._v(" \\\n"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("--")]),s._v("data"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v("raw '"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"name"')]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"Java进阶"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"price"')]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("130")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"description"')]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('" updateJava yyds"')]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("'\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br"),a("span",{staticClass:"line-number"},[s._v("9")]),a("br")])])]),s._v(" "),a("li",[a("p",[s._v("删除文档")]),s._v(" "),a("div",{staticClass:"language-java line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-java"}},[a("code",[s._v("DELETE http"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("localhost"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("9200")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("索引名"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("_doc"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("文档"),a("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("Id")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\ncurl "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("--")]),s._v("location "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("--")]),s._v("request DELETE "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("'http://localhost:9200/course/_doc/qvPHW3oBBs5dY2098vLu'")]),s._v("\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br")])])]),s._v(" "),a("li",[a("p",[s._v("搜索所有文档")]),s._v(" "),a("div",{staticClass:"language-java line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-java"}},[a("code",[s._v("GET http"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("localhost"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("9200")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("索引"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("_doc"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("_search\ncurl "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("--")]),s._v("location "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("--")]),s._v("request GET "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("'http://localhost:9200/course/_doc/_search'")]),s._v("\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br")])])]),s._v(" "),a("li",[a("p",[s._v("根据文档Id查询文档")]),s._v(" "),a("div",{staticClass:"language-java line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-java"}},[a("code",[s._v("GET http"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("localhost"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("9200")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("索引名"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("_doc"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("文档"),a("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("Id")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n\ncurl "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("--")]),s._v("location "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("--")]),s._v("request GET "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("'http://localhost:9200/course/_doc/qvPHW3oBBs5dY2098vLu'")]),s._v("\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br")])])]),s._v(" "),a("li",[a("p",[s._v("搜索指定参数文档")]),s._v(" "),a("div",{staticClass:"language-java line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-java"}},[a("code",[s._v("GET http"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("localhost"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("9200")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("索引"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("_doc"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("_search"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("?")]),s._v("q"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("参数key"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("查询值"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n\ncurl "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("--")]),s._v("location "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("--")]),s._v("request GET "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("'http://localhost:9200/course/_doc/_search?q=name:java'")]),s._v("\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br")])])])]),s._v(" "),a("h2",{attrs:{id:"五、数据类型"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#五、数据类型"}},[s._v("#")]),s._v(" 五、数据类型")]),s._v(" "),a("h3",{attrs:{id:"字符串类型"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#字符串类型"}},[s._v("#")]),s._v(" 字符串类型")]),s._v(" "),a("p",[a("a",{attrs:{href:"https://www.elastic.co/guide/en/elasticsearch/reference/6.8/text.html",target:"_blank",rel:"noopener noreferrer"}},[s._v("Elasticsearch 指南 [6.8] - 文本数据类型"),a("OutboundLink")],1)]),s._v(" "),a("p",[s._v("字符串 "),a("code",[s._v("string")]),s._v(" 可被分为 "),a("code",[s._v("text")]),s._v(" 和 "),a("code",[s._v("keyword")]),s._v(" 类型。若不为索引指定映射，6.x 版本的 es 会把字符串定义为 "),a("strong",[s._v("text")]),s._v("类型，并增加一个"),a("strong",[s._v("keyword")]),s._v("的类型字段。")]),s._v(" "),a("ol",[a("li",[s._v("text")])]),s._v(" "),a("p",[s._v("文本数据类型，该类型下字符串会被分词，并根据字符串内容生成倒排索引，便于查询。主要用于适合分词查询的场景。")]),s._v(" "),a("ul",[a("li",[a("p",[s._v("analyzer")]),s._v(" "),a("p",[s._v("text类型支持分词，可通过 analyzer 属性指定分词器。")]),s._v(" "),a("p",[s._v("比如：指定参数的字段类型为text，设置 IK 分词器的分词模式。")]),s._v(" "),a("div",{staticClass:"language-java line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-java"}},[a("code",[a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"name"')]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n\t"),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"type"')]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"text"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n\t"),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"analyzer"')]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"ik_max_word"')]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br")])]),a("p",[s._v("上边指定在索引（动词）和搜索的时候都进行细粒度分词。单独定义搜索时使用的分词级别可设置"),a("code",[s._v("search_analyzer")]),s._v("属性。")]),s._v(" "),a("div",{staticClass:"language-java line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-java"}},[a("code",[a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"name"')]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n\t"),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"type"')]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"text"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n\t"),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"analyzer"')]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"ik_max_word"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n\t"),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"search_analyzer"')]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"ik_smart"')]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br")])]),a("p",[s._v("这里指定在索引的时候使用细粒度分词，在查询的时候使用粗粒度。（可提高查询精度）")])]),s._v(" "),a("li",[a("p",[s._v("index")]),s._v(" "),a("p",[s._v("可以通过设置 index 属性指定字段是否索引。")]),s._v(" "),a("p",[s._v("默认为 "),a("code",[s._v("index = true")]),s._v("，即都需要索引。设置字段需要索引，字段对应信息才会在索引库生成。")]),s._v(" "),a("p",[s._v("当有些字段不需要索引时（图片，邮箱等），就可以通过设置 index 实现。")]),s._v(" "),a("div",{staticClass:"language-java line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-java"}},[a("code",[a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"pic"')]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n\t"),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"type"')]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"text"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n\t"),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"index"')]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),a("span",{pre:!0,attrs:{class:"token boolean"}},[s._v("false")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br")])])])]),s._v(" "),a("ol",{attrs:{start:"2"}},[a("li",[s._v("keyword")])]),s._v(" "),a("p",[s._v("关键字数据类型，该类型字符串不会被分词，主要用于准确匹配的字符串。比如身份证号、邮箱地址等。查询的时候只能根据完整字符串查询。")]),s._v(" "),a("div",{staticClass:"language-java line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-java"}},[a("code",[a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"name"')]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n   "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"type"')]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"keyword"')]),s._v("\n  "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br")])]),a("h3",{attrs:{id:"数值类型"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#数值类型"}},[s._v("#")]),s._v(" 数值类型")]),s._v(" "),a("p",[a("a",{attrs:{href:"https://www.elastic.co/guide/en/elasticsearch/reference/6.8/number.html#number",target:"_blank",rel:"noopener noreferrer"}},[s._v("Elasticsearch 指南 [6.8] - 数字数据类型"),a("OutboundLink")],1)]),s._v(" "),a("p",[s._v("Elasticsearch 支持以下数字类型。")]),s._v(" "),a("p",[a("img",{attrs:{src:"https://cdn.jsdelivr.net/gh/AlbertYang0801/pic-bed@main/img/20210630164104.png",alt:""}})]),s._v(" "),a("ul",[a("li",[a("p",[s._v("为了提高搜索效率，应尽可能选择范围小的数值类型。")])]),s._v(" "),a("li",[a("p",[s._v("选择浮点数的时候，尽量使用比例因子。")]),s._v(" "),a("p",[s._v("比如价格信息，单位为元，将比例因子设置为 100 的话 es 会按照分存储。比如输入价格23.123元，存入 es 中会按照 21134 存储。")]),s._v(" "),a("div",{staticClass:"language-java line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-java"}},[a("code",[a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"price"')]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n        "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"type"')]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"scaled_float"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n        "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"scaling_factor"')]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("100")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br")])]),a("p",[s._v("选用比例因子的好处就是比浮点数容易计算，更容易压缩，节省磁盘空间。")])])]),s._v(" "),a("h3",{attrs:{id:"日期类型"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#日期类型"}},[s._v("#")]),s._v(" 日期类型")]),s._v(" "),a("p",[a("a",{attrs:{href:"https://www.elastic.co/guide/en/elasticsearch/reference/6.8/date.html",target:"_blank",rel:"noopener noreferrer"}},[s._v("Elasticsearch 指南 [6.8]-日期数据类型"),a("OutboundLink")],1)]),s._v(" "),a("p",[s._v("日期类型不用分词，通常日期类型用于排序等操作。")]),s._v(" "),a("ul",[a("li",[a("p",[s._v("format")]),s._v(" "),a("p",[s._v("日期格式可以通过 format 自定义，但如果没有"),a("code",[s._v("format")]),s._v("指定，则使用默认值：")]),s._v(" "),a("div",{staticClass:"language-java line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-java"}},[a("code",[a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"strict_date_optional_time||epoch_millis"')]),s._v("\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br")])]),a("p",[s._v("这意味着它将接受带有可选时间戳的日期，这些时间戳符合"),a("a",{attrs:{href:"https://www.elastic.co/guide/en/elasticsearch/reference/6.8/mapping-date-format.html#strict-date-time",target:"_blank",rel:"noopener noreferrer"}},[a("code",[s._v("strict_date_optional_time")]),a("OutboundLink")],1),s._v(" 或 纪元以来的毫秒数支持的格式。")]),s._v(" "),a("p",[s._v("在设置字段的时候可以通过 format 设置日期格式。")]),s._v(" "),a("div",{staticClass:"language-java line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-java"}},[a("code",[a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v(" \n  "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"properties"')]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" \n  \t"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v(" \n      "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"timestamp"')]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" \n      \t"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v(" \t\n          "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"type"')]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"date"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"format"')]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"yyyy‐MM‐dd HH:mm:ss||yyyy‐MM‐dd"')]),s._v(" \n        "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v(" \n    "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v(" \n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br"),a("span",{staticClass:"line-number"},[s._v("9")]),a("br")])]),a("p",[s._v("对应插入文档的参数为：")]),s._v(" "),a("div",{staticClass:"language-java line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-java"}},[a("code",[a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n\t"),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"timestamp"')]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"2018‐07‐04 18:28:58"')]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br")])])])]),s._v(" "),a("h2",{attrs:{id:"六、分词机制"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#六、分词机制"}},[s._v("#")]),s._v(" 六、分词机制")]),s._v(" "),a("p",[s._v("IK 分词器默认有两种分词模式，还支持自定义词库。")]),s._v(" "),a("p",[s._v("一种是粗粒度分词 "),a("code",[s._v("ik_smart")]),s._v(" ，另一种是细粒度分词 "),a("code",[s._v("ik_max_word")]),s._v("。")]),s._v(" "),a("h3",{attrs:{id:"粗粒度分词"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#粗粒度分词"}},[s._v("#")]),s._v(" 粗粒度分词")]),s._v(" "),a("p",[s._v("设置 "),a("code",[s._v("analyzer")]),s._v("为"),a("code",[s._v("ik_smart")]),s._v(" 会将文本进行"),a("strong",[s._v("粗粒度")]),s._v("拆分。")]),s._v(" "),a("p",[a("img",{attrs:{src:"https://cdn.jsdelivr.net/gh/AlbertYang0801/pic-bed@main/img/20210630164115.png",alt:""}})]),s._v(" "),a("h3",{attrs:{id:"细粒度分词"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#细粒度分词"}},[s._v("#")]),s._v(" 细粒度分词")]),s._v(" "),a("p",[s._v("设置 "),a("code",[s._v("analyzer")]),s._v("为 "),a("code",[s._v("ik_max_word")]),s._v("会将文本进行"),a("strong",[s._v("细粒度")]),s._v("拆分。")]),s._v(" "),a("p",[a("img",{attrs:{src:"https://cdn.jsdelivr.net/gh/AlbertYang0801/pic-bed@main/img/20210630164115.png",alt:""}})]),s._v(" "),a("h2",{attrs:{id:"参考链接"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#参考链接"}},[s._v("#")]),s._v(" 参考链接")]),s._v(" "),a("ul",[a("li",[a("a",{attrs:{href:"https://www.elastic.co/guide/en/elasticsearch/reference/6.8/index.html",target:"_blank",rel:"noopener noreferrer"}},[s._v("Elasticsearch Guide"),a("OutboundLink")],1)]),s._v(" "),a("li",[a("a",{attrs:{href:"https://blog.csdn.net/Cobbyer/article/details/109814110",target:"_blank",rel:"noopener noreferrer"}},[s._v("ES五| Elasticsearch的映射(字段类型)和分析"),a("OutboundLink")],1)])])])}),[],!1,null,null,null);t.default=r.exports}}]);