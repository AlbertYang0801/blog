(window.webpackJsonp=window.webpackJsonp||[]).push([[73],{433:function(s,a,t){"use strict";t.r(a);var e=t(26),r=Object(e.a)({},(function(){var s=this,a=s.$createElement,t=s._self._c||a;return t("ContentSlotsDistributor",{attrs:{"slot-key":s.$parent.slotKey}},[t("h1",{attrs:{id:"elasticsearch总结"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#elasticsearch总结"}},[s._v("#")]),s._v(" Elasticsearch总结")]),s._v(" "),t("h2",{attrs:{id:"一、es-简介"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#一、es-简介"}},[s._v("#")]),s._v(" 一、ES 简介")]),s._v(" "),t("h3",{attrs:{id:"elasticsearch介绍"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#elasticsearch介绍"}},[s._v("#")]),s._v(" Elasticsearch介绍")]),s._v(" "),t("p",[t("strong",[s._v("百度百科")])]),s._v(" "),t("blockquote",[t("p",[s._v("Elasticsearch 是一个分布式、高扩展、高实时的搜索与"),t("a",{attrs:{href:"https://baike.baidu.com/item/%E6%95%B0%E6%8D%AE%E5%88%86%E6%9E%90/6577123",target:"_blank",rel:"noopener noreferrer"}},[s._v("数据分析"),t("OutboundLink")],1),s._v("引擎。它能很方便的使大量数据具有搜索、分析和探索的能力。充分利用Elasticsearch的水平伸缩性，能使数据在生产环境变得更有价值。Elasticsearch 的实现原理主要分为以下几个步骤，首先用户将数据提交到Elasticsearch 数据库中，再通过分词控制器去将对应的语句分词，将其权重和分词结果一并存入数据，当用户搜索数据时候，再根据权重将结果排名，打分，再将返回结果呈现给用户。")]),s._v(" "),t("p",[s._v("Elasticsearch是与名为Logstash的数据收集和日志解析引擎以及名为Kibana的分析和可视化平台一起开发的。这三个产品被设计成一个集成解决方案，称为“Elastic Stack”（以前称为“ELK stack”）。")]),s._v(" "),t("p",[s._v("Elasticsearch可以用于搜索各种文档。它提供可扩展的搜索，具有接近实时的搜索，并支持多租户。”Elasticsearch是分布式的，这意味着索引可以被分成分片，每个分片可以有0个或多个副本。每个节点托管一个或多个分片，并充当协调器将操作委托给正确的分片。再平衡和路由是自动完成的。“相关数据通常存储在同一个索引中，该索引由一个或多个主分片和零个或多个复制分片组成。一旦创建了索引，就不能更改主分片的数量。")]),s._v(" "),t("p",[s._v("Elasticsearch使用Lucene，并试图通过JSON和Java API提供其所有特性。它支持facetting和percolating，如果新文档与注册查询匹配，这对于通知非常有用。另一个特性称为“网关”，处理索引的长期持久性；例如，在服务器崩溃的情况下，可以从网关恢复索引。Elasticsearch支持实时GET请求，适合作为NoSQL数据存储，但缺少"),t("a",{attrs:{href:"https://baike.baidu.com/item/%E5%88%86%E5%B8%83%E5%BC%8F/7316617",target:"_blank",rel:"noopener noreferrer"}},[s._v("分布式"),t("OutboundLink")],1),s._v("事务。")])]),s._v(" "),t("p",[t("strong",[s._v("总结")])]),s._v(" "),t("ol",[t("li",[s._v("Elasticsearch 是一个基于 Lucene 的高扩展性分布式搜索服务器。")]),s._v(" "),t("li",[s._v("Elasticsearch 隐藏了 Lucene 的复杂性，对外提供 Restful 接口来操作。")])]),s._v(" "),t("h3",{attrs:{id:"elk-stack"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#elk-stack"}},[s._v("#")]),s._v(" Elk Stack")]),s._v(" "),t("p",[s._v("ELK Stack 是 Elasticsearch、Logstash、Kibana 三大开源框架的合集简称。")]),s._v(" "),t("ol",[t("li",[s._v("Elasticsearch  是一个基于Lucene、可分布式、近实时的搜索引擎，其通过 Restful 方式进行交互。")]),s._v(" "),t("li",[s._v("Logstash 是一个数据引擎，可将不用来源数据对接进 Elasticsearch 或其它目的地中。")]),s._v(" "),t("li",[s._v("Kibana 是一个数据可视化平台 。")])]),s._v(" "),t("h3",{attrs:{id:"elasticsearch通信方式"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#elasticsearch通信方式"}},[s._v("#")]),s._v(" Elasticsearch通信方式")]),s._v(" "),t("ul",[t("li",[s._v("Java客户端通信 "),t("strong",[s._v("9300")]),s._v(" 端口。")]),s._v(" "),t("li",[s._v("Restful方式通信，HTTP服务所在的端口，默认为 "),t("strong",[s._v("9200")]),s._v(" 端口。")])]),s._v(" "),t("h3",{attrs:{id:"搜索引擎对比"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#搜索引擎对比"}},[s._v("#")]),s._v(" 搜索引擎对比")]),s._v(" "),t("p",[t("strong",[s._v("Elasticsearch vs Solr 总结")])]),s._v(" "),t("ol",[t("li",[s._v("es 基本是开箱即用，非常简单。Solr 安装略微复杂。")]),s._v(" "),t("li",[s._v("Solr 利用 Zookeeper 进行分布式管理，而 Elasticsearch 自身带有分布式协调管理功能。")]),s._v(" "),t("li",[s._v("Solr 支持更多格式的数据，比如 JSON、XML、CSV，而 Elasticsearch 仅支持 json 文件格式。")]),s._v(" "),t("li",[s._v("Solr 官方提供的功能更多，而 Elasticsearch 本身更注重于核心功能，高级功能多有第三方插件提供，例如图形化界面需要kibana友好支撑")]),s._v(" "),t("li",[s._v("Solr 查询快，但更新索引时慢（即插入删除慢），用于电商等查询多的应用；")]),s._v(" "),t("li",[s._v("ES建立索引快（即查询慢），即实时性查询快，用于 facebook 新浪等搜索。")]),s._v(" "),t("li",[s._v("是传统搜索应用的有力解决方案，但 Elasticsearch 更适用于新兴的实时搜索应用。")]),s._v(" "),t("li",[s._v("Solr 比较成熟，有一个更大，更成熟的用户、开发和贡献者社区，而 Elasticsearch 相对开发维护者较少，更新太快，学习使用成本较高。")])]),s._v(" "),t("h2",{attrs:{id:"二、环境安装"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#二、环境安装"}},[s._v("#")]),s._v(" 二、环境安装")]),s._v(" "),t("h3",{attrs:{id:"elasticsearch-本地安装"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#elasticsearch-本地安装"}},[s._v("#")]),s._v(" Elasticsearch 本地安装")]),s._v(" "),t("p",[s._v("本地安装 7.10.2 版本，解压即可。")]),s._v(" "),t("p",[t("a",{attrs:{href:"https://www.elastic.co/cn/downloads/past-releases/elasticsearch-7-10-2",target:"_blank",rel:"noopener noreferrer"}},[s._v("Elasticsearch 7.10.2下载地址"),t("OutboundLink")],1)]),s._v(" "),t("p",[t("img",{attrs:{src:"https://cdn.jsdelivr.net/gh/AlbertYang0801/pic-bed@main/img/20210628110258.png",alt:""}})]),s._v(" "),t("ul",[t("li",[t("p",[s._v("启动命令")]),s._v(" "),t("p",[t("code",[s._v("./bin/elasticsearch")])])]),s._v(" "),t("li",[t("p",[s._v("校验安装是否成功")]),s._v(" "),t("p",[s._v("直接在浏览器输入："),t("a",{attrs:{href:"http://localhost:9200",target:"_blank",rel:"noopener noreferrer"}},[s._v("http://localhost:9200"),t("OutboundLink")],1),s._v("，出现如下结果表示安装成功。")]),s._v(" "),t("p",[t("img",{attrs:{src:"https://cdn.jsdelivr.net/gh/AlbertYang0801/pic-bed@main/img/20210628110332.png",alt:""}})]),s._v(" "),t("blockquote",[t("p",[s._v("You Know, for Search")])])])]),s._v(" "),t("h3",{attrs:{id:"es-head-插件"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#es-head-插件"}},[s._v("#")]),s._v(" Es-head 插件")]),s._v(" "),t("p",[s._v("谷歌浏览器可以配置 es-head 插件，配置成功之后可直接连接 Es。（连接采用 Restful 方式通信，使用的是 9200 端口）")]),s._v(" "),t("p",[t("img",{attrs:{src:"https://cdn.jsdelivr.net/gh/AlbertYang0801/pic-bed@main/img/20210628110429.png",alt:""}})]),s._v(" "),t("ol",[t("li",[t("p",[s._v("复合查询")]),s._v(" "),t("p",[s._v("可以调用 Restful 接口，执行各种操作。")]),s._v(" "),t("p",[s._v("例如：向指定索引新增文档。")]),s._v(" "),t("p",[t("img",{attrs:{src:"https://cdn.jsdelivr.net/gh/AlbertYang0801/pic-bed@main/img/20210628110503.png",alt:""}})]),s._v(" "),t("p",[t("img",{attrs:{src:"https://cdn.jsdelivr.net/gh/AlbertYang0801/pic-bed@main/img/20210628110515.png",alt:""}})])]),s._v(" "),t("li",[t("p",[s._v("基本查询")]),s._v(" "),t("p",[s._v("基本查询可以按照插件提供的搜索条件进行查询。")]),s._v(" "),t("p",[t("img",{attrs:{src:"https://cdn.jsdelivr.net/gh/AlbertYang0801/pic-bed@main/img/20210628110526.png",alt:""}})]),s._v(" "),t("p",[t("img",{attrs:{src:"https://cdn.jsdelivr.net/gh/AlbertYang0801/pic-bed@main/img/20210628110536.png",alt:""}})])])]),s._v(" "),t("h3",{attrs:{id:"kibana"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#kibana"}},[s._v("#")]),s._v(" Kibana")]),s._v(" "),t("p",[s._v("使用 brew 安装。（注意：kibana 版本需和 ES 保持一致）")]),s._v(" "),t("ul",[t("li",[t("p",[s._v("搜索可用版本")]),s._v(" "),t("p",[t("code",[s._v("brew search kibana")])]),s._v(" "),t("p",[t("img",{attrs:{src:"https://cdn.jsdelivr.net/gh/AlbertYang0801/pic-bed@main/img/20210628110808.png",alt:""}})])]),s._v(" "),t("li",[t("p",[s._v("安装默认版本")]),s._v(" "),t("p",[t("code",[s._v("brew install kibana")])]),s._v(" "),t("p",[t("img",{attrs:{src:"https://cdn.jsdelivr.net/gh/AlbertYang0801/pic-bed@main/img/20210628110819.png",alt:""}})])]),s._v(" "),t("li",[t("p",[s._v("kibana存放目录")]),s._v(" "),t("p",[t("code",[s._v("/usr/local/Cellar/kibana/7.10.2")])]),s._v(" "),t("p",[t("img",{attrs:{src:"https://cdn.jsdelivr.net/gh/AlbertYang0801/pic-bed@main/img/20210628110846.png",alt:""}})])])]),s._v(" "),t("h3",{attrs:{id:"ik-分词器"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#ik-分词器"}},[s._v("#")]),s._v(" IK 分词器")]),s._v(" "),t("p",[s._v("Elasticsearch 默认对中文不分词，所以需要安装 IK 分词器插件。")]),s._v(" "),t("p",[t("strong",[s._v("1. 分词器安装")])]),s._v(" "),t("ul",[t("li",[s._v("安装包下载")])]),s._v(" "),t("p",[t("a",{attrs:{href:"https://github.com/medcl/elasticsearch-analysis-ik/releases",target:"_blank",rel:"noopener noreferrer"}},[s._v("下载地址"),t("OutboundLink")],1),s._v("（注意：分词器版本和 ES 版本保持一致。）")]),s._v(" "),t("ul",[t("li",[s._v("在 ES 根目录下的 "),t("code",[s._v("plugins")]),s._v(" 文件夹创建 "),t("code",[s._v("analysis-ik")]),s._v(" 目录，并将下载的安装包 "),t("code",[s._v("elasticsearch-analysis-ik-7.10.2.zip")]),s._v(" 解压到该目录并删除压缩包。")])]),s._v(" "),t("p",[t("img",{attrs:{src:"https://cdn.jsdelivr.net/gh/AlbertYang0801/pic-bed@main/img/20210628111108.png",alt:""}})]),s._v(" "),t("p",[t("strong",[s._v("2. 分词测试")])]),s._v(" "),t("ul",[t("li",[t("p",[s._v("接口测试")]),s._v(" "),t("div",{staticClass:"language-java line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-java"}},[t("code",[s._v("curl "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("--")]),s._v("location "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("--")]),s._v("request POST "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v("'http://localhost:9200/course/_analyze'")]),s._v(" \\\n"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("--")]),s._v("header "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v("'Content-Type: application/json'")]),s._v(" \\\n"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("--")]),s._v("data"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v("raw '"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n  "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"text"')]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"测试分词器，中文默认单词分开输出"')]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n  "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"analyzer"')]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"ik_max_word"')]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("'\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br"),t("span",{staticClass:"line-number"},[s._v("6")]),t("br")])])]),s._v(" "),t("li",[t("p",[s._v("未分词之前")])])]),s._v(" "),t("p",[t("img",{attrs:{src:"https://cdn.jsdelivr.net/gh/AlbertYang0801/pic-bed@main/img/20210628111135.png",alt:""}})]),s._v(" "),t("ul",[t("li",[s._v("分词之后")])]),s._v(" "),t("p",[t("img",{attrs:{src:"https://cdn.jsdelivr.net/gh/AlbertYang0801/pic-bed@main/img/20210628111144.png",alt:""}})]),s._v(" "),t("h2",{attrs:{id:"三、elasticsearch基础概念"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#三、elasticsearch基础概念"}},[s._v("#")]),s._v(" 三、Elasticsearch基础概念")]),s._v(" "),t("h3",{attrs:{id:"索引库-index"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#索引库-index"}},[s._v("#")]),s._v(" 索引库（index）")]),s._v(" "),t("p",[s._v("Elasticsearch的索引库是一个逻辑上的概念，存储了相同类型的文档内容。类似于 MySQL 数据表，MongoDB 中的集合。")]),s._v(" "),t("ol",[t("li",[t("p",[s._v("新建索引库")]),s._v(" "),t("ul",[t("li",[t("p",[s._v("number_of_shards")]),s._v(" "),t("p",[s._v("设置分片的数量，在集群中通常设置多个分片，表示一个索引库将拆分成多片分别存储不同 的结点，提高了ES的处理能力和高可用性，入门程序使用单机环境，这里设置为 1。")])]),s._v(" "),t("li",[t("p",[s._v("number_of_replicas")]),s._v(" "),t("p",[s._v("设置副本的数量，设置副本是为了提高ES的高可靠性，单机环境设置为 0。")])])])]),s._v(" "),t("li",[t("p",[s._v("新建测试")]),s._v(" "),t("p",[s._v("例如新建一个 order 索引库，5 个分片，无副本。")]),s._v(" "),t("div",{staticClass:"language-java line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-java"}},[t("code",[s._v("curl "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("--")]),s._v("location "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("--")]),s._v("request PUT "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v("'http://localhost:9200/order/'")]),s._v(" \\\n"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("--")]),s._v("header "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v("'Content-Type: application/json'")]),s._v(" \\\n"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("--")]),s._v("data"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v("raw '"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"settings"')]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n        "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"index"')]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n            "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"number_of_shards"')]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("5")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n            "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"number_of_replicas"')]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v("\n        "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("'\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br"),t("span",{staticClass:"line-number"},[s._v("6")]),t("br"),t("span",{staticClass:"line-number"},[s._v("7")]),t("br"),t("span",{staticClass:"line-number"},[s._v("8")]),t("br"),t("span",{staticClass:"line-number"},[s._v("9")]),t("br"),t("span",{staticClass:"line-number"},[s._v("10")]),t("br")])]),t("p",[t("img",{attrs:{src:"https://cdn.jsdelivr.net/gh/AlbertYang0801/pic-bed@main/img/20210628112620.png",alt:""}})])]),s._v(" "),t("li",[t("p",[s._v("索引含义区分")]),s._v(" "),t("ul",[t("li",[t("p",[s._v("索引（名词）")]),s._v(" "),t("p",[s._v("一个索引（index）对应一个索引库，就像是传统关系数据库 MySQL 中的数据库，是存储文档的地方。")])]),s._v(" "),t("li",[t("p",[s._v("索引（动词）")]),s._v(" "),t("p",[s._v("索引一个文档，代表将一个文档存储到索引库里，以便于文档被检索或者查询。")]),s._v(" "),t("p",[s._v("类似于 MySQL 中的 "),t("code",[s._v("INSERT")]),s._v("  插入数据，不同的是索引会将旧文档覆盖。")])]),s._v(" "),t("li",[t("p",[s._v("倒排索引")]),s._v(" "),t("p",[s._v("在传统数据库中为了提高查询效率，通常会为特定列增加索引来达到。")]),s._v(" "),t("p",[s._v("而在 Es 中采用了"),t("strong",[s._v("倒排索引")]),s._v("的数据结构来提高查询效率。")])])])])]),s._v(" "),t("h3",{attrs:{id:"类型-type"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#类型-type"}},[s._v("#")]),s._v(" 类型（_type)")]),s._v(" "),t("p",[s._v("映射元数据字段中的"),t("code",[s._v("_type")]),s._v(" 字段。代表着索引的类型，每个文档中都会有"),t("code",[s._v("_type")]),s._v("字段信息进行区分文档。")]),s._v(" "),t("blockquote",[t("p",[s._v("Elasticse arch 官网提出的近期版本对 type 概念的演变情况如下：")]),s._v(" "),t("p",[s._v("在 5.X 版本中，一个 index 下可以创建多个 type；")]),s._v(" "),t("p",[s._v("在 6.X 版本中，一个 index 下只能存在一个 type；")]),s._v(" "),t("p",[s._v("在 7.X 版本中，直接去除了 type 的概念，就是说 index 不再会有 type。")])]),s._v(" "),t("p",[t("strong",[s._v("为什么ElasticSearch要在7.X版本去掉type?")])]),s._v(" "),t("blockquote",[t("p",[s._v("ES 最先的设计是用索引类比关系型数据库的数据库，用 "),t("code",[s._v("mapping type")]),s._v(" 来类比表，一个索引中可以包含多个映射类别。这个类比存在一个严重的问题，就是当多个mapping type中存在同名字段时（特别是同名字段还是不同类型的），在一个索引中不好处理，因为搜索引擎中只有 索引-文档的结构，不同映射类别的数据都是一个一个的文档（只是包含的字段不一样而已）")])]),s._v(" "),t("h3",{attrs:{id:"映射-mapping"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#映射-mapping"}},[s._v("#")]),s._v(" 映射（mapping）")]),s._v(" "),t("p",[s._v("映射定义索引中有什么字段、进行字段类型确认。类似于数据库中表结构定义。")]),s._v(" "),t("ol",[t("li",[s._v("元字段")])]),s._v(" "),t("p",[s._v("每个文档都有与之关联的元数据，例如"),t("code",[s._v("_index")]),s._v("、"),t("code",[s._v("_type")]),s._v("和 "),t("code",[s._v("_id")]),s._v(" 等字段。创建映射类型时，可以自定义其中一些元数据字段的行为。")]),s._v(" "),t("table",[t("thead",[t("tr",[t("th",[s._v("元数据字段")]),s._v(" "),t("th",[s._v("含义")])])]),s._v(" "),t("tbody",[t("tr",[t("td",[s._v("_index")]),s._v(" "),t("td",[s._v("文档所属索引")])]),s._v(" "),t("tr",[t("td",[s._v("_type")]),s._v(" "),t("td",[s._v("文档映射类型（7.x 已废弃）")])]),s._v(" "),t("tr",[t("td",[s._v("_id")]),s._v(" "),t("td",[s._v("文档 ID")])]),s._v(" "),t("tr",[t("td",[s._v("_source")]),s._v(" "),t("td",[s._v("表示文档正文的原始 JSON")])])])]),s._v(" "),t("p",[t("a",{attrs:{href:"https://www.elastic.co/guide/en/elasticsearch/reference/current/mapping-fields.html",target:"_blank",rel:"noopener noreferrer"}},[s._v("Elasticsearch Guide [7.13]-Mapping-Metadata fields"),t("OutboundLink")],1)]),s._v(" "),t("ol",{attrs:{start:"2"}},[t("li",[s._v("ES 支持"),t("strong",[s._v("手动定义映射")]),s._v("和"),t("strong",[s._v("动态映射")]),s._v("两种映射方式。")])]),s._v(" "),t("ul",[t("li",[t("p",[t("strong",[s._v("动态映射")])]),s._v(" "),t("p",[s._v("默认情况下，当在文档中找到以前未见过的字段时，Elasticsearch 会将新字段添加到类型映射中。"),t("a",{attrs:{href:"https://www.elastic.co/guide/en/elasticsearch/reference/6.8/object.html",target:"_blank",rel:"noopener noreferrer"}},[t("code",[s._v("object")]),t("OutboundLink")],1),s._v(" 通过将"),t("a",{attrs:{href:"https://www.elastic.co/guide/en/elasticsearch/reference/6.8/dynamic.html",target:"_blank",rel:"noopener noreferrer"}},[t("code",[s._v("dynamic")]),t("OutboundLink")],1),s._v("参数设置为"),t("code",[s._v("false")]),s._v("（忽略新字段）或设置为"),t("code",[s._v("strict")]),s._v("（在遇到未知字段时抛出异常），可以在文档和级别禁用此行为。（6.8 版本和 7.x 版本字段映射关系不同）。")]),s._v(" "),t("p",[s._v("6.8字段映射关系截图：")]),s._v(" "),t("p",[s._v("![image-20210629111920245](/Users/yangjunwei/Library/Application Support/typora-user-images/image-20210629111920245.png)")]),s._v(" "),t("p",[s._v("参考："),t("a",{attrs:{href:"https://www.elastic.co/guide/en/elasticsearch/reference/6.8/dynamic-field-mapping.html",target:"_blank",rel:"noopener noreferrer"}},[s._v("Elasticsearch Guide [6.8]- Dynamic field mapping"),t("OutboundLink")],1)])]),s._v(" "),t("li",[t("p",[t("strong",[s._v("手动映射")])]),s._v(" "),t("p",[s._v("可以通过 RestAPI 请求手动指定索引的映射。")]),s._v(" "),t("div",{staticClass:"language-java line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-java"}},[t("code",[s._v("curl "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("--")]),s._v("location "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("--")]),s._v("request POST "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v("'localhost:9200/course/_mapping'")]),s._v(" \\\n"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("--")]),s._v("header "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v("'Content-Type: application/json'")]),s._v(" \\\n"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("--")]),s._v("data"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v("raw '"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"properties"')]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n        "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"name"')]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n            "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"type"')]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"text"')]),s._v("\n        "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n        "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"description"')]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n            "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"type"')]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"text"')]),s._v("\n        "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n        "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"studymodel"')]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n            "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"type"')]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"keyword"')]),s._v("\n        "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("'\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br"),t("span",{staticClass:"line-number"},[s._v("6")]),t("br"),t("span",{staticClass:"line-number"},[s._v("7")]),t("br"),t("span",{staticClass:"line-number"},[s._v("8")]),t("br"),t("span",{staticClass:"line-number"},[s._v("9")]),t("br"),t("span",{staticClass:"line-number"},[s._v("10")]),t("br"),t("span",{staticClass:"line-number"},[s._v("11")]),t("br"),t("span",{staticClass:"line-number"},[s._v("12")]),t("br"),t("span",{staticClass:"line-number"},[s._v("13")]),t("br"),t("span",{staticClass:"line-number"},[s._v("14")]),t("br"),t("span",{staticClass:"line-number"},[s._v("15")]),t("br")])]),t("ul",[t("li",[t("p",[s._v("查看索引映射")]),s._v(" "),t("div",{staticClass:"language-java line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-java"}},[t("code",[t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("//查看所有映射")]),s._v("\ncurl "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("--")]),s._v("location "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("--")]),s._v("request GET "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v("'http://localhost:9200/_mapping'")]),s._v("\n  \n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("//查看指定索引的映射")]),s._v("\ncurl "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("--")]),s._v("location "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("--")]),s._v("request GET "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v("'localhost:9200/{索引}/_mapping'")]),s._v("\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br")])])]),s._v(" "),t("li",[t("p",[s._v("创建映射")]),s._v(" "),t("div",{staticClass:"language-java line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-java"}},[t("code",[s._v("POST localhost"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("9200")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("索引名"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("_mapping\n  \n  \ncurl "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("--")]),s._v("location "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("--")]),s._v("request POST "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v("'localhost:9200/course/_mapping'")]),s._v(" \\\n"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("--")]),s._v("header "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v("'Content-Type: application/json'")]),s._v(" \\\n"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("--")]),s._v("data"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v("raw '"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"properties"')]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n        "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"name"')]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n            "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"type"')]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"text"')]),s._v("\n        "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n        "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"description"')]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n            "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"type"')]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"text"')]),s._v("\n        "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n        "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"price"')]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n            "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"type"')]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"long"')]),s._v("\n        "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("'\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br"),t("span",{staticClass:"line-number"},[s._v("6")]),t("br"),t("span",{staticClass:"line-number"},[s._v("7")]),t("br"),t("span",{staticClass:"line-number"},[s._v("8")]),t("br"),t("span",{staticClass:"line-number"},[s._v("9")]),t("br"),t("span",{staticClass:"line-number"},[s._v("10")]),t("br"),t("span",{staticClass:"line-number"},[s._v("11")]),t("br"),t("span",{staticClass:"line-number"},[s._v("12")]),t("br"),t("span",{staticClass:"line-number"},[s._v("13")]),t("br"),t("span",{staticClass:"line-number"},[s._v("14")]),t("br"),t("span",{staticClass:"line-number"},[s._v("15")]),t("br"),t("span",{staticClass:"line-number"},[s._v("16")]),t("br"),t("span",{staticClass:"line-number"},[s._v("17")]),t("br"),t("span",{staticClass:"line-number"},[s._v("18")]),t("br")])])]),s._v(" "),t("li",[t("p",[s._v("更新映射")]),s._v(" "),t("p",[s._v("映射创建成功之后，已有字段不允许更新，可以添加新字段。")])]),s._v(" "),t("li",[t("p",[s._v("删除映射")]),s._v(" "),t("p",[s._v("通过删除索引来删除映射。")])])])])]),s._v(" "),t("h3",{attrs:{id:"文档-documents"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#文档-documents"}},[s._v("#")]),s._v(" 文档（documents）")]),s._v(" "),t("p",[s._v("ES 是面向文档的，搜索和索引数据的最小单位是文档。官方文档基础介绍。")]),s._v(" "),t("blockquote",[t("p",[s._v("文档是可以被索引的基本信息单元。例如，您可以为单个客户创建一个文档，为单个产品创建另一个文档，以及为单个订单创建另一个文档。该文档以 JSON（JavaScript Object Notation）表示，这是一种普遍存在的互联网数据交换格式。")]),s._v(" "),t("p",[s._v("在索引/类型中，您可以存储任意数量的文档。请注意，尽管文档物理上位于索引中，但文档实际上必须被索引/分配给索引内的类型。")])]),s._v(" "),t("p",[t("strong",[s._v("ES 中的文档类似 MySQL 数据表中的记录")]),s._v("。")]),s._v(" "),t("p",[s._v("ES 可以存储数据复杂的数据，而且每个数据还存在索引，便于搜索文档内容。）（关系型数据库存储数据结构复杂的数据时，先要打散数据存入数据库，再取出的时候往往需要拼接数据）")]),s._v(" "),t("ul",[t("li",[t("p",[s._v("创建文档")]),s._v(" "),t("p",[s._v("不指定Id的话，es 会自动创建 Id。")]),s._v(" "),t("div",{staticClass:"language-java line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-java"}},[t("code",[s._v("POST http"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("localhost"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("9200")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("索引名"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("_doc"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("id"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n\n\ncurl "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("--")]),s._v("location "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("--")]),s._v("request POST "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v("'http://localhost:9200/course/_doc'")]),s._v(" \\\n"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("--")]),s._v("header "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v("'Content-Type: application/json'")]),s._v(" \\\n"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("--")]),s._v("data"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v("raw '"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"name"')]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"Java进阶"')]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"price"')]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("120")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"description"')]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"Java yyds"')]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("'\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br"),t("span",{staticClass:"line-number"},[s._v("6")]),t("br"),t("span",{staticClass:"line-number"},[s._v("7")]),t("br"),t("span",{staticClass:"line-number"},[s._v("8")]),t("br"),t("span",{staticClass:"line-number"},[s._v("9")]),t("br"),t("span",{staticClass:"line-number"},[s._v("10")]),t("br")])])]),s._v(" "),t("li",[t("p",[s._v("更新文档")]),s._v(" "),t("div",{staticClass:"language-java line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-java"}},[t("code",[s._v("POST http"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("localhost"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("9200")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("索引名"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("_doc"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("文档"),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("Id")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n\ncurl "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("--")]),s._v("location "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("--")]),s._v("request POST "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v("'http://localhost:9200/course/_doc/q_PQW3oBBs5dY209hPKx'")]),s._v(" \\\n"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("--")]),s._v("header "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v("'Content-Type: application/json'")]),s._v(" \\\n"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("--")]),s._v("data"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v("raw '"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"name"')]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"Java进阶"')]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"price"')]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("130")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"description"')]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('" updateJava yyds"')]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("'\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br"),t("span",{staticClass:"line-number"},[s._v("6")]),t("br"),t("span",{staticClass:"line-number"},[s._v("7")]),t("br"),t("span",{staticClass:"line-number"},[s._v("8")]),t("br"),t("span",{staticClass:"line-number"},[s._v("9")]),t("br")])])]),s._v(" "),t("li",[t("p",[s._v("删除文档")]),s._v(" "),t("div",{staticClass:"language-java line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-java"}},[t("code",[s._v("DELETE http"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("localhost"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("9200")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("索引名"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("_doc"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("文档"),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("Id")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\ncurl "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("--")]),s._v("location "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("--")]),s._v("request DELETE "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v("'http://localhost:9200/course/_doc/qvPHW3oBBs5dY2098vLu'")]),s._v("\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br")])])]),s._v(" "),t("li",[t("p",[s._v("搜索所有文档")]),s._v(" "),t("div",{staticClass:"language-java line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-java"}},[t("code",[s._v("GET http"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("localhost"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("9200")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("索引"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("_doc"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("_search\ncurl "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("--")]),s._v("location "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("--")]),s._v("request GET "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v("'http://localhost:9200/course/_doc/_search'")]),s._v("\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br")])])]),s._v(" "),t("li",[t("p",[s._v("根据文档Id查询文档")]),s._v(" "),t("div",{staticClass:"language-java line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-java"}},[t("code",[s._v("GET http"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("localhost"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("9200")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("索引名"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("_doc"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("文档"),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("Id")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n\ncurl "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("--")]),s._v("location "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("--")]),s._v("request GET "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v("'http://localhost:9200/course/_doc/qvPHW3oBBs5dY2098vLu'")]),s._v("\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br")])])]),s._v(" "),t("li",[t("p",[s._v("搜索指定参数文档")]),s._v(" "),t("div",{staticClass:"language-java line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-java"}},[t("code",[s._v("GET http"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("localhost"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("9200")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("索引"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("_doc"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("_search"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("?")]),s._v("q"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("参数key"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("查询值"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n\ncurl "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("--")]),s._v("location "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("--")]),s._v("request GET "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v("'http://localhost:9200/course/_doc/_search?q=name:java'")]),s._v("\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br")])])])]),s._v(" "),t("h3",{attrs:{id:"数据类型"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#数据类型"}},[s._v("#")]),s._v(" 数据类型")]),s._v(" "),t("ol",[t("li",[t("p",[s._v("字符串类型")]),s._v(" "),t("p",[t("a",{attrs:{href:"https://www.elastic.co/guide/en/elasticsearch/reference/6.8/text.html",target:"_blank",rel:"noopener noreferrer"}},[s._v("Elasticsearch 指南 [6.8] - 文本数据类型"),t("OutboundLink")],1)]),s._v(" "),t("p",[s._v("字符串 "),t("code",[s._v("string")]),s._v(" 可被分为 "),t("code",[s._v("text")]),s._v(" 和 "),t("code",[s._v("keyword")]),s._v(" 类型。若不为索引指定映射，6.x 版本的 es 会把字符串定义为 "),t("strong",[s._v("text")]),s._v("类型，并增加一个"),t("strong",[s._v("keyword")]),s._v("的类型字段。")]),s._v(" "),t("p",[s._v("1.1 text")]),s._v(" "),t("p",[s._v("文本数据类型，该类型下字符串会被分词，并根据字符串内容生成倒排索引，便于查询。主要用于适合分词查询的场景。")]),s._v(" "),t("ul",[t("li",[t("p",[s._v("analyzer")]),s._v(" "),t("p",[s._v("text类型支持分词，可通过 analyzer 属性指定分词器。")]),s._v(" "),t("p",[s._v("比如：指定参数的字段类型为text，设置 IK 分词器的分词模式。")]),s._v(" "),t("div",{staticClass:"language-java line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-java"}},[t("code",[t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"name"')]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n\t"),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"type"')]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"text"')]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n\t"),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"analyzer"')]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"ik_max_word"')]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br")])]),t("p",[s._v("上边指定在索引（动词）和搜索的时候都进行细粒度分词。单独定义搜索时使用的分词级别可设置"),t("code",[s._v("search_analyzer")]),s._v("属性。")]),s._v(" "),t("div",{staticClass:"language-java line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-java"}},[t("code",[t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"name"')]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n\t"),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"type"')]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"text"')]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n\t"),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"analyzer"')]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"ik_max_word"')]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n\t"),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"search_analyzer"')]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"ik_smart"')]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br")])]),t("p",[s._v("这里指定在索引的时候使用细粒度分词，在查询的时候使用粗粒度。（可提高查询精度）")])]),s._v(" "),t("li",[t("p",[s._v("index")]),s._v(" "),t("p",[s._v("可以通过设置 index 属性指定字段是否索引。")]),s._v(" "),t("p",[s._v("默认为 "),t("code",[s._v("index = true")]),s._v("，即都需要索引。设置字段需要索引，字段对应信息才会在索引库生成。")]),s._v(" "),t("p",[s._v("当有些字段不需要索引时（图片，邮箱等），就可以通过设置 index 实现。")]),s._v(" "),t("div",{staticClass:"language- line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[s._v('"pic":{\n\t"type":"text",\n\t"index":false\n}\n')])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br")])])])]),s._v(" "),t("p",[s._v("1.2 keyword")]),s._v(" "),t("p",[s._v("关键字数据类型，该类型字符串不会被分词，主要用于准确匹配的字符串。比如身份证号、邮箱地址等。查询的时候只能根据完整字符串查询。")]),s._v(" "),t("div",{staticClass:"language- line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[s._v('  "name":{\n   "type":"keyword"\n  }\n')])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br")])])]),s._v(" "),t("li",[t("p",[s._v("数值类型")]),s._v(" "),t("p",[t("a",{attrs:{href:"https://www.elastic.co/guide/en/elasticsearch/reference/6.8/number.html#number",target:"_blank",rel:"noopener noreferrer"}},[s._v("Elasticsearch 指南 [6.8] - 数字数据类型"),t("OutboundLink")],1)]),s._v(" "),t("p",[s._v("es 支持以下数字类型。")]),s._v(" "),t("p",[s._v("![image-20210630150551353](/Users/yangjunwei/Library/Application Support/typora-user-images/image-20210630150551353.png)")]),s._v(" "),t("ul",[t("li",[t("p",[s._v("为了提高搜索效率，应尽可能选择范围小的数值类型。")])]),s._v(" "),t("li",[t("p",[s._v("选择浮点数的时候，尽量使用比例因子。")]),s._v(" "),t("p",[s._v("比如价格信息，单位为元，将比例因子设置为 100 的话 es 会按照分存储。比如输入价格23.123元，存入 es 中会按照 21134 存储。")]),s._v(" "),t("div",{staticClass:"language-java line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-java"}},[t("code",[t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"price"')]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n        "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"type"')]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"scaled_float"')]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n        "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"scaling_factor"')]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("100")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br"),t("span",{staticClass:"line-number"},[s._v("6")]),t("br")])]),t("p",[s._v("选用比例因子的好处就是比浮点数容易计算，更容易压缩，节省磁盘空间。")])])])]),s._v(" "),t("li",[t("p",[s._v("日期类型")]),s._v(" "),t("p",[t("a",{attrs:{href:"https://www.elastic.co/guide/en/elasticsearch/reference/6.8/date.html",target:"_blank",rel:"noopener noreferrer"}},[s._v("Elasticsearch 指南 [6.8]-日期数据类型"),t("OutboundLink")],1)]),s._v(" "),t("p",[s._v("日期类型不用分词，通常日期类型用于排序等操作。")]),s._v(" "),t("ul",[t("li",[t("p",[s._v("format")]),s._v(" "),t("p",[s._v("日期格式可以通过 format 自定义，但如果没有"),t("code",[s._v("format")]),s._v("指定，则使用默认值：")]),s._v(" "),t("div",{staticClass:"language-java line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-java"}},[t("code",[t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"strict_date_optional_time||epoch_millis"')]),s._v("\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br")])]),t("p",[s._v("这意味着它将接受带有可选时间戳的日期，这些时间戳符合"),t("a",{attrs:{href:"https://www.elastic.co/guide/en/elasticsearch/reference/6.8/mapping-date-format.html#strict-date-time",target:"_blank",rel:"noopener noreferrer"}},[t("code",[s._v("strict_date_optional_time")]),t("OutboundLink")],1),s._v(" 或 纪元以来的毫秒数支持的格式。")]),s._v(" "),t("p",[s._v("在设置字段的时候可以通过 format 设置日期格式。")]),s._v(" "),t("div",{staticClass:"language-java line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-java"}},[t("code",[t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v(" \n  "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"properties"')]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" \n  \t"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v(" \n      "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"timestamp"')]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" \n      \t"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v(" \t\n          "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"type"')]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"date"')]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"format"')]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"yyyy‐MM‐dd HH:mm:ss||yyyy‐MM‐dd"')]),s._v(" \n        "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v(" \n    "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v(" \n"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br"),t("span",{staticClass:"line-number"},[s._v("6")]),t("br"),t("span",{staticClass:"line-number"},[s._v("7")]),t("br"),t("span",{staticClass:"line-number"},[s._v("8")]),t("br"),t("span",{staticClass:"line-number"},[s._v("9")]),t("br")])]),t("p",[s._v("对应插入文档的参数为：")]),s._v(" "),t("div",{staticClass:"language-java line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-java"}},[t("code",[t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n\t"),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"timestamp"')]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"2018‐07‐04 18:28:58"')]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br")])])])])])]),s._v(" "),t("h3",{attrs:{id:"分词机制"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#分词机制"}},[s._v("#")]),s._v(" 分词机制")]),s._v(" "),t("p",[s._v("IK 分词器默认有两种分词模式，还支持自定义词库。")]),s._v(" "),t("p",[s._v("一种是粗粒度分词 "),t("code",[s._v("ik_smart")]),s._v(" ，另一种是细粒度分词 "),t("code",[s._v("ik_max_word")]),s._v("。")]),s._v(" "),t("ul",[t("li",[t("p",[t("code",[s._v("ik_smart")])]),s._v(" "),t("p",[s._v("会将文本进行"),t("strong",[s._v("粗粒度")]),s._v("拆分。")]),s._v(" "),t("p",[s._v("![image-20210630105757378](/Users/yangjunwei/Library/Application Support/typora-user-images/image-20210630105757378.png)")])]),s._v(" "),t("li",[t("p",[t("code",[s._v("ik_max_word")])]),s._v(" "),t("p",[s._v("会将文本进行"),t("strong",[s._v("细粒度")]),s._v("拆分。")]),s._v(" "),t("p",[s._v("![image-20210630105817693](/Users/yangjunwei/Library/Application Support/typora-user-images/image-20210630105817693.png)")])])]),s._v(" "),t("h3",{attrs:{id:"倒排索引-重要"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#倒排索引-重要"}},[s._v("#")]),s._v(" 倒排索引 （重要）")]),s._v(" "),t("p",[s._v("https://lanffy.github.io/2019/05/10/Inverted-Index-In-Elasticsearch")]),s._v(" "),t("p",[t("a",{attrs:{href:"https://blog.csdn.net/hguisu/article/details/7962350",target:"_blank",rel:"noopener noreferrer"}},[s._v("搜索引擎-倒排索引基础知识"),t("OutboundLink")],1)]),s._v(" "),t("blockquote",[t("p",[s._v("MySQL ：查找包含的值。先查到行数据，再查看行数据是否包含查找值。")]),s._v(" "),t("p",[s._v("倒排索引：查找包含的值。先找到该值，查看包含该值的文档。（每个文档都要被分词）")])]),s._v(" "),t("p",[s._v("![image-20210624212136428](/Users/yangjunwei/Library/Application Support/typora-user-images/image-20210624212136428.png)")]),s._v(" "),t("h2",{attrs:{id:"四、dsl-查询"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#四、dsl-查询"}},[s._v("#")]),s._v(" 四、DSL 查询")]),s._v(" "),t("p",[t("img",{attrs:{src:"https://img-blog.csdnimg.cn/20200602225308707.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3J1bmV3Ymll,size_16,color_FFFFFF,t_70",alt:""}})]),s._v(" "),t("h2",{attrs:{id:"参考链接"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#参考链接"}},[s._v("#")]),s._v(" 参考链接")]),s._v(" "),t("ul",[t("li",[t("a",{attrs:{href:"https://baike.baidu.com/item/elasticsearch/3411206?fr=aladdin",target:"_blank",rel:"noopener noreferrer"}},[s._v("百度百科 - elasticsearch"),t("OutboundLink")],1)]),s._v(" "),t("li",[s._v("["),t("a",{attrs:{href:"https://www.elastic.co/guide/cn/elasticsearch/guide/current/index.html",target:"_blank",rel:"noopener noreferrer"}},[s._v("Elasticsearch: 权威指南"),t("OutboundLink")],1),s._v("](https://www.elastic.co/guide/cn/elasticsearch/guide/current/mapping-intro.html)")]),s._v(" "),t("li",[t("a",{attrs:{href:"https://www.elastic.co/guide/en/elasticsearch/reference/6.8/index.html",target:"_blank",rel:"noopener noreferrer"}},[s._v("Elasticsearch Guide"),t("OutboundLink")],1)]),s._v(" "),t("li",[t("a",{attrs:{href:"https://www.cnblogs.com/blueskyli/p/8326229.html",target:"_blank",rel:"noopener noreferrer"}},[s._v("ElasticSearch和solr的差别"),t("OutboundLink")],1)]),s._v(" "),t("li",[t("a",{attrs:{href:"https://blog.csdn.net/Cobbyer/article/details/109814110",target:"_blank",rel:"noopener noreferrer"}},[s._v("ES五| Elasticsearch的映射(字段类型)和分析"),t("OutboundLink")],1)])])])}),[],!1,null,null,null);a.default=r.exports}}]);