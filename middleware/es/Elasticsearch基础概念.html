<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>基础概念 | 技术小站</title>
    <meta name="generator" content="VuePress 1.8.2">
    <link rel="icon" href="logo.ico">
    <meta name="description" content="生活不止眼前的代码，还有迈向田野的步伐">
    
    <link rel="preload" href="/blog/assets/css/0.styles.069fd700.css" as="style"><link rel="preload" href="/blog/assets/js/app.b7b681ef.js" as="script"><link rel="preload" href="/blog/assets/js/2.7ded94f8.js" as="script"><link rel="preload" href="/blog/assets/js/77.bdabe94a.js" as="script"><link rel="prefetch" href="/blog/assets/js/10.085630e1.js"><link rel="prefetch" href="/blog/assets/js/11.1e0e1220.js"><link rel="prefetch" href="/blog/assets/js/12.2243e9d1.js"><link rel="prefetch" href="/blog/assets/js/13.2f0749c3.js"><link rel="prefetch" href="/blog/assets/js/14.4ee95829.js"><link rel="prefetch" href="/blog/assets/js/15.22319292.js"><link rel="prefetch" href="/blog/assets/js/16.6b62ca38.js"><link rel="prefetch" href="/blog/assets/js/17.2a02e7ed.js"><link rel="prefetch" href="/blog/assets/js/18.830c139d.js"><link rel="prefetch" href="/blog/assets/js/19.88f1535a.js"><link rel="prefetch" href="/blog/assets/js/20.06472fe5.js"><link rel="prefetch" href="/blog/assets/js/21.f1ae1d62.js"><link rel="prefetch" href="/blog/assets/js/22.a0a3f565.js"><link rel="prefetch" href="/blog/assets/js/23.9069fc92.js"><link rel="prefetch" href="/blog/assets/js/24.42308680.js"><link rel="prefetch" href="/blog/assets/js/25.1aeda03b.js"><link rel="prefetch" href="/blog/assets/js/26.9a43fba8.js"><link rel="prefetch" href="/blog/assets/js/27.16c530c0.js"><link rel="prefetch" href="/blog/assets/js/28.b1c786ef.js"><link rel="prefetch" href="/blog/assets/js/29.6cc41c84.js"><link rel="prefetch" href="/blog/assets/js/3.488cc73a.js"><link rel="prefetch" href="/blog/assets/js/30.11852ae4.js"><link rel="prefetch" href="/blog/assets/js/31.e27aa4d3.js"><link rel="prefetch" href="/blog/assets/js/32.ab4ec115.js"><link rel="prefetch" href="/blog/assets/js/33.dce16933.js"><link rel="prefetch" href="/blog/assets/js/34.2496455e.js"><link rel="prefetch" href="/blog/assets/js/35.6a61362f.js"><link rel="prefetch" href="/blog/assets/js/36.2413bea7.js"><link rel="prefetch" href="/blog/assets/js/37.0b10c6a4.js"><link rel="prefetch" href="/blog/assets/js/38.5ad84eaa.js"><link rel="prefetch" href="/blog/assets/js/39.884c9260.js"><link rel="prefetch" href="/blog/assets/js/4.56fda3ff.js"><link rel="prefetch" href="/blog/assets/js/40.8e9bdd48.js"><link rel="prefetch" href="/blog/assets/js/41.bcc2f3b6.js"><link rel="prefetch" href="/blog/assets/js/42.29168801.js"><link rel="prefetch" href="/blog/assets/js/43.c833e928.js"><link rel="prefetch" href="/blog/assets/js/44.9ba96919.js"><link rel="prefetch" href="/blog/assets/js/45.d31f3140.js"><link rel="prefetch" href="/blog/assets/js/46.ae4977b8.js"><link rel="prefetch" href="/blog/assets/js/47.63b32bc4.js"><link rel="prefetch" href="/blog/assets/js/48.c49f424f.js"><link rel="prefetch" href="/blog/assets/js/49.c548dde8.js"><link rel="prefetch" href="/blog/assets/js/5.7d16fc96.js"><link rel="prefetch" href="/blog/assets/js/50.527578b8.js"><link rel="prefetch" href="/blog/assets/js/51.01724638.js"><link rel="prefetch" href="/blog/assets/js/52.d0c97558.js"><link rel="prefetch" href="/blog/assets/js/53.792aa552.js"><link rel="prefetch" href="/blog/assets/js/54.8d7b7b6d.js"><link rel="prefetch" href="/blog/assets/js/55.9e8fe85b.js"><link rel="prefetch" href="/blog/assets/js/56.713c663a.js"><link rel="prefetch" href="/blog/assets/js/57.7a4a4d15.js"><link rel="prefetch" href="/blog/assets/js/58.c9314761.js"><link rel="prefetch" href="/blog/assets/js/59.f5539ad3.js"><link rel="prefetch" href="/blog/assets/js/6.c1bd8a18.js"><link rel="prefetch" href="/blog/assets/js/60.c18d1f37.js"><link rel="prefetch" href="/blog/assets/js/61.2e108aa2.js"><link rel="prefetch" href="/blog/assets/js/62.a0149b09.js"><link rel="prefetch" href="/blog/assets/js/63.24cc4322.js"><link rel="prefetch" href="/blog/assets/js/64.9776a06e.js"><link rel="prefetch" href="/blog/assets/js/65.803ab2ca.js"><link rel="prefetch" href="/blog/assets/js/66.74e3f2a9.js"><link rel="prefetch" href="/blog/assets/js/67.602ae500.js"><link rel="prefetch" href="/blog/assets/js/68.22a19e13.js"><link rel="prefetch" href="/blog/assets/js/69.bc13f04c.js"><link rel="prefetch" href="/blog/assets/js/7.35bf9e08.js"><link rel="prefetch" href="/blog/assets/js/70.73473db9.js"><link rel="prefetch" href="/blog/assets/js/71.2fa5813a.js"><link rel="prefetch" href="/blog/assets/js/72.20b30b51.js"><link rel="prefetch" href="/blog/assets/js/73.bd4730d8.js"><link rel="prefetch" href="/blog/assets/js/74.31e56ae7.js"><link rel="prefetch" href="/blog/assets/js/75.a5a9b9aa.js"><link rel="prefetch" href="/blog/assets/js/76.3cb919aa.js"><link rel="prefetch" href="/blog/assets/js/78.2f0fd77d.js"><link rel="prefetch" href="/blog/assets/js/79.b3e7ab06.js"><link rel="prefetch" href="/blog/assets/js/8.62dcffed.js"><link rel="prefetch" href="/blog/assets/js/80.8f66061e.js"><link rel="prefetch" href="/blog/assets/js/81.aa4cb1b3.js"><link rel="prefetch" href="/blog/assets/js/82.9df1cd7f.js"><link rel="prefetch" href="/blog/assets/js/83.5d18ddc9.js"><link rel="prefetch" href="/blog/assets/js/84.666080b1.js"><link rel="prefetch" href="/blog/assets/js/85.988464b2.js"><link rel="prefetch" href="/blog/assets/js/86.acfdf5df.js"><link rel="prefetch" href="/blog/assets/js/87.5c9cbbb2.js"><link rel="prefetch" href="/blog/assets/js/88.64d79e00.js"><link rel="prefetch" href="/blog/assets/js/89.132f67a0.js"><link rel="prefetch" href="/blog/assets/js/9.c16fb42f.js"><link rel="prefetch" href="/blog/assets/js/90.075d16fc.js"><link rel="prefetch" href="/blog/assets/js/91.e1110bbb.js"><link rel="prefetch" href="/blog/assets/js/92.c3bb7bd9.js"><link rel="prefetch" href="/blog/assets/js/93.590677e1.js"><link rel="prefetch" href="/blog/assets/js/94.75c53e90.js"><link rel="prefetch" href="/blog/assets/js/95.2b5703e8.js"><link rel="prefetch" href="/blog/assets/js/96.08fbec93.js"><link rel="prefetch" href="/blog/assets/js/97.875f65ed.js"><link rel="prefetch" href="/blog/assets/js/98.c8a1cc9d.js"><link rel="prefetch" href="/blog/assets/js/99.eeea5795.js">
    <link rel="stylesheet" href="/blog/assets/css/0.styles.069fd700.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/blog/" class="home-link router-link-active"><!----> <span class="site-name">技术小站</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/blog/" class="nav-link">
  首页
</a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="Java篇" class="dropdown-title"><span class="title">Java篇</span> <span class="arrow down"></span></button> <button type="button" aria-label="Java篇" class="mobile-dropdown-title"><span class="title">Java篇</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/blog/java/collection/" class="nav-link">
  Java容器
</a></li><li class="dropdown-item"><!----> <a href="/blog/java/jvm/" class="nav-link">
  JVM虚拟机
</a></li><li class="dropdown-item"><!----> <a href="/blog/java/concurrent/" class="nav-link">
  高并发
</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="数据库" class="dropdown-title"><span class="title">数据库</span> <span class="arrow down"></span></button> <button type="button" aria-label="数据库" class="mobile-dropdown-title"><span class="title">数据库</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/blog/database/mysql/" class="nav-link">
  MySQL
</a></li><li class="dropdown-item"><!----> <a href="/blog/database/redis/" class="nav-link">
  Redis
</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="框架篇" class="dropdown-title"><span class="title">框架篇</span> <span class="arrow down"></span></button> <button type="button" aria-label="框架篇" class="mobile-dropdown-title"><span class="title">框架篇</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/blog/frame/spring/" class="nav-link">
  Spring
</a></li><li class="dropdown-item"><!----> <a href="/blog/frame/springboot/" class="nav-link">
  SpringBoot
</a></li><li class="dropdown-item"><!----> <a href="/blog/frame/mybatis/" class="nav-link">
  MyBatis
</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="中间件" class="dropdown-title"><span class="title">中间件</span> <span class="arrow down"></span></button> <button type="button" aria-label="中间件" class="mobile-dropdown-title"><span class="title">中间件</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/blog/middleware/es/" class="nav-link router-link-active">
  Elasticsearch
</a></li></ul></div></div><div class="nav-item"><a href="/blog/design/" class="nav-link">
  设计模式
</a></div><div class="nav-item"><a href="/blog/util/" class="nav-link">
  工具向
</a></div><div class="nav-item"><a href="/blog/personal/" class="nav-link">
  关于我
</a></div> <!----></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><nav class="nav-links"><div class="nav-item"><a href="/blog/" class="nav-link">
  首页
</a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="Java篇" class="dropdown-title"><span class="title">Java篇</span> <span class="arrow down"></span></button> <button type="button" aria-label="Java篇" class="mobile-dropdown-title"><span class="title">Java篇</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/blog/java/collection/" class="nav-link">
  Java容器
</a></li><li class="dropdown-item"><!----> <a href="/blog/java/jvm/" class="nav-link">
  JVM虚拟机
</a></li><li class="dropdown-item"><!----> <a href="/blog/java/concurrent/" class="nav-link">
  高并发
</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="数据库" class="dropdown-title"><span class="title">数据库</span> <span class="arrow down"></span></button> <button type="button" aria-label="数据库" class="mobile-dropdown-title"><span class="title">数据库</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/blog/database/mysql/" class="nav-link">
  MySQL
</a></li><li class="dropdown-item"><!----> <a href="/blog/database/redis/" class="nav-link">
  Redis
</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="框架篇" class="dropdown-title"><span class="title">框架篇</span> <span class="arrow down"></span></button> <button type="button" aria-label="框架篇" class="mobile-dropdown-title"><span class="title">框架篇</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/blog/frame/spring/" class="nav-link">
  Spring
</a></li><li class="dropdown-item"><!----> <a href="/blog/frame/springboot/" class="nav-link">
  SpringBoot
</a></li><li class="dropdown-item"><!----> <a href="/blog/frame/mybatis/" class="nav-link">
  MyBatis
</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="中间件" class="dropdown-title"><span class="title">中间件</span> <span class="arrow down"></span></button> <button type="button" aria-label="中间件" class="mobile-dropdown-title"><span class="title">中间件</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/blog/middleware/es/" class="nav-link router-link-active">
  Elasticsearch
</a></li></ul></div></div><div class="nav-item"><a href="/blog/design/" class="nav-link">
  设计模式
</a></div><div class="nav-item"><a href="/blog/util/" class="nav-link">
  工具向
</a></div><div class="nav-item"><a href="/blog/personal/" class="nav-link">
  关于我
</a></div> <!----></nav>  <ul class="sidebar-links"><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading open"><span>elasticsearch</span> <span class="arrow down"></span></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/blog/middleware/es/Elasticsearch简介.html" class="sidebar-link">Elasticsearch简介</a></li><li><a href="/blog/middleware/es/Elasticsearch环境安装.html" class="sidebar-link">环境安装</a></li><li><a href="/blog/middleware/es/Elasticsearch基础概念.html" class="active sidebar-link">基础概念</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/blog/middleware/es/Elasticsearch基础概念.html#一、索引库-index" class="sidebar-link">一、索引库（index）</a></li><li class="sidebar-sub-header"><a href="/blog/middleware/es/Elasticsearch基础概念.html#二、类型-type" class="sidebar-link">二、类型（_type)</a></li><li class="sidebar-sub-header"><a href="/blog/middleware/es/Elasticsearch基础概念.html#三、映射-mapping" class="sidebar-link">三、映射（mapping）</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/blog/middleware/es/Elasticsearch基础概念.html#元字段" class="sidebar-link">元字段</a></li><li class="sidebar-sub-header"><a href="/blog/middleware/es/Elasticsearch基础概念.html#映射方式" class="sidebar-link">映射方式</a></li><li class="sidebar-sub-header"><a href="/blog/middleware/es/Elasticsearch基础概念.html#常用-api" class="sidebar-link">常用 API</a></li></ul></li><li class="sidebar-sub-header"><a href="/blog/middleware/es/Elasticsearch基础概念.html#三、文档-documents" class="sidebar-link">三、文档（documents）</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/blog/middleware/es/Elasticsearch基础概念.html#常用-api-2" class="sidebar-link">常用 API</a></li></ul></li><li class="sidebar-sub-header"><a href="/blog/middleware/es/Elasticsearch基础概念.html#四、数据类型" class="sidebar-link">四、数据类型</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/blog/middleware/es/Elasticsearch基础概念.html#字符串类型" class="sidebar-link">字符串类型</a></li><li class="sidebar-sub-header"><a href="/blog/middleware/es/Elasticsearch基础概念.html#数值类型" class="sidebar-link">数值类型</a></li><li class="sidebar-sub-header"><a href="/blog/middleware/es/Elasticsearch基础概念.html#日期类型" class="sidebar-link">日期类型</a></li></ul></li><li class="sidebar-sub-header"><a href="/blog/middleware/es/Elasticsearch基础概念.html#五、分词机制" class="sidebar-link">五、分词机制</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/blog/middleware/es/Elasticsearch基础概念.html#粗粒度分词" class="sidebar-link">粗粒度分词</a></li><li class="sidebar-sub-header"><a href="/blog/middleware/es/Elasticsearch基础概念.html#细粒度分词" class="sidebar-link">细粒度分词</a></li></ul></li><li class="sidebar-sub-header"><a href="/blog/middleware/es/Elasticsearch基础概念.html#参考链接" class="sidebar-link">参考链接</a></li></ul></li><li><a href="/blog/middleware/es/Elasticsearch检索.html" class="sidebar-link">Elasticsearch检索</a></li><li><a href="/blog/middleware/es/倒排索引原理.html" class="sidebar-link">倒排索引原理</a></li></ul></section></li></ul> </aside> <main class="page"> <div class="theme-default-content content__default"><h1 id="基础概念"><a href="#基础概念" class="header-anchor">#</a> 基础概念</h1> <h2 id="一、索引库-index"><a href="#一、索引库-index" class="header-anchor">#</a> 一、索引库（index）</h2> <p>Elasticsearch的索引库是一个逻辑上的概念，存储了相同类型的文档内容。类似于 MySQL 数据表，MongoDB 中的集合。</p> <ol><li><p>新建索引库</p> <ul><li><p>number_of_shards</p> <p>设置分片的数量，在集群中通常设置多个分片，表示一个索引库将拆分成多片分别存储不同 的结点，提高了ES的处理能力和高可用性，入门程序使用单机环境，这里设置为 1。</p></li> <li><p>number_of_replicas</p> <p>设置副本的数量，设置副本是为了提高ES的高可靠性，单机环境设置为 0。</p></li></ul></li> <li><p>新建测试</p> <p>例如新建一个 order 索引库，5 个分片，无副本。</p> <div class="language-java line-numbers-mode"><pre class="language-java"><code>curl <span class="token operator">--</span>location <span class="token operator">--</span>request PUT <span class="token string">'http://localhost:9200/order/'</span> \
<span class="token operator">--</span>header <span class="token string">'Content-Type: application/json'</span> \
<span class="token operator">--</span>data<span class="token operator">-</span>raw '<span class="token punctuation">{</span>
    <span class="token string">&quot;settings&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
        <span class="token string">&quot;index&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
            <span class="token string">&quot;number_of_shards&quot;</span><span class="token operator">:</span> <span class="token number">5</span><span class="token punctuation">,</span>
            <span class="token string">&quot;number_of_replicas&quot;</span><span class="token operator">:</span> <span class="token number">0</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>'
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br></div></div><p><img src="https://cdn.jsdelivr.net/gh/AlbertYang0801/pic-bed@main/img/20210628112620.png" alt=""></p></li> <li><p>索引含义区分</p> <ul><li><p>索引（名词）</p> <p>一个索引（index）对应一个索引库，就像是传统关系数据库 MySQL 中的数据库，是存储文档的地方。</p></li> <li><p>索引（动词）</p> <p>索引一个文档，代表将一个文档存储到索引库里，以便于文档被检索或者查询。</p> <p>类似于 MySQL 中的 <code>INSERT</code>  插入数据，不同的是索引会将旧文档覆盖。</p></li> <li><p>倒排索引</p> <p>在传统数据库中为了提高查询效率，通常会为特定列增加索引来达到。</p> <p>而在 Es 中采用了<strong>倒排索引</strong>的数据结构来提高查询效率。</p></li></ul></li></ol> <h2 id="二、类型-type"><a href="#二、类型-type" class="header-anchor">#</a> 二、类型（_type)</h2> <p>映射的元数据字段中的<code>_type</code> 字段。代表着索引的类型，每个文档中都会有<code>_type</code>字段信息进行区分文档。</p> <blockquote><p>Elasticse arch 官网提出的近期版本对 type 概念的演变情况如下：</p> <p>在 5.X 版本中，一个 index 下可以创建多个 type；</p> <p>在 6.X 版本中，一个 index 下只能存在一个 type；默认为 _doc；</p> <p>在 7.X 版本中，直接去除了 type 的概念，就是说 index 不再会有 type。</p></blockquote> <p><strong>为什么ElasticSearch要在7.X版本去掉type?</strong></p> <blockquote><p>ES 最先的设计是用索引类比关系型数据库的数据库，用 <code>mapping type</code> 来类比表，一个索引中可以包含多个映射类别。这个类比存在一个严重的问题，就是当多个mapping type中存在同名字段时（特别是同名字段还是不同类型的），在一个索引中不好处理，因为搜索引擎中只有 索引-文档的结构，不同映射类别的数据都是一个一个的文档（只是包含的字段不一样而已）</p></blockquote> <h2 id="三、映射-mapping"><a href="#三、映射-mapping" class="header-anchor">#</a> 三、映射（mapping）</h2> <p>映射定义索引中有什么字段、进行字段类型确认。类似于数据库中表结构定义。</p> <h3 id="元字段"><a href="#元字段" class="header-anchor">#</a> 元字段</h3> <p>每个文档都有与之关联的元数据，例如<code>_index</code>、<code>_type</code>和 <code>_id</code> 等字段。创建映射类型时，可以自定义其中一些元数据字段的行为。</p> <table><thead><tr><th>元数据字段</th> <th>含义</th></tr></thead> <tbody><tr><td>_index</td> <td>文档所属索引</td></tr> <tr><td>_type</td> <td>文档映射类型（7.x 已废弃）</td></tr> <tr><td>_id</td> <td>文档 ID</td></tr> <tr><td>_source</td> <td>表示文档正文的原始 JSON</td></tr></tbody></table> <p><a href="https://www.elastic.co/guide/en/elasticsearch/reference/current/mapping-fields.html" target="_blank" rel="noopener noreferrer">Elasticsearch Guide [7.13]-Mapping-Metadata fields<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></p> <h3 id="映射方式"><a href="#映射方式" class="header-anchor">#</a> 映射方式</h3> <p>ES 支持<strong>手动定义映射</strong>和<strong>动态映射</strong>两种映射方式。</p> <ol><li><p><strong>动态映射</strong></p> <p>默认情况下，当在文档中找到以前未见过的字段时，Elasticsearch 会将新字段添加到类型映射中。<a href="https://www.elastic.co/guide/en/elasticsearch/reference/6.8/object.html" target="_blank" rel="noopener noreferrer"><code>object</code><span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a> 通过将<a href="https://www.elastic.co/guide/en/elasticsearch/reference/6.8/dynamic.html" target="_blank" rel="noopener noreferrer"><code>dynamic</code><span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>参数设置为<code>false</code>（忽略新字段）或设置为<code>strict</code>（在遇到未知字段时抛出异常），可以在文档和级别禁用此行为。（6.8 版本和 7.x 版本字段映射关系不同）。</p> <p>6.8 版本字段映射关系截图：</p> <p><img src="https://cdn.jsdelivr.net/gh/AlbertYang0801/pic-bed@main/img/20210630164041.png" alt=""></p> <p>参考：<a href="https://www.elastic.co/guide/en/elasticsearch/reference/6.8/dynamic-field-mapping.html" target="_blank" rel="noopener noreferrer">Elasticsearch Guide [6.8]- Dynamic field mapping<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></p></li> <li><p><strong>手动映射</strong></p> <p>可以通过 RestAPI 请求手动指定索引的映射。</p> <div class="language-java line-numbers-mode"><pre class="language-java"><code>curl <span class="token operator">--</span>location <span class="token operator">--</span>request POST <span class="token string">'localhost:9200/course/_mapping'</span> \
<span class="token operator">--</span>header <span class="token string">'Content-Type: application/json'</span> \
<span class="token operator">--</span>data<span class="token operator">-</span>raw '<span class="token punctuation">{</span>
    <span class="token string">&quot;properties&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
        <span class="token string">&quot;name&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
            <span class="token string">&quot;type&quot;</span><span class="token operator">:</span> <span class="token string">&quot;text&quot;</span>
        <span class="token punctuation">}</span><span class="token punctuation">,</span>
        <span class="token string">&quot;description&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
            <span class="token string">&quot;type&quot;</span><span class="token operator">:</span> <span class="token string">&quot;text&quot;</span>
        <span class="token punctuation">}</span><span class="token punctuation">,</span>
        <span class="token string">&quot;studymodel&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
            <span class="token string">&quot;type&quot;</span><span class="token operator">:</span> <span class="token string">&quot;keyword&quot;</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>'
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br></div></div></li></ol> <h3 id="常用-api"><a href="#常用-api" class="header-anchor">#</a> 常用 API</h3> <ol><li><p>索引映射</p> <div class="language-java line-numbers-mode"><pre class="language-java"><code><span class="token comment">//查看所有映射</span>
curl <span class="token operator">--</span>location <span class="token operator">--</span>request GET <span class="token string">'http://localhost:9200/_mapping'</span>

<span class="token comment">//查看指定索引的映射</span>
curl <span class="token operator">--</span>location <span class="token operator">--</span>request GET <span class="token string">'localhost:9200/{索引}/_mapping'</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div></li> <li><p>创建映射</p> <div class="language-java line-numbers-mode"><pre class="language-java"><code>POST localhost<span class="token operator">:</span><span class="token number">9200</span><span class="token operator">/</span><span class="token punctuation">{</span>索引名<span class="token punctuation">}</span><span class="token operator">/</span>_mapping

curl <span class="token operator">--</span>location <span class="token operator">--</span>request POST <span class="token string">'localhost:9200/course/_mapping'</span> \
<span class="token operator">--</span>header <span class="token string">'Content-Type: application/json'</span> \
<span class="token operator">--</span>data<span class="token operator">-</span>raw '<span class="token punctuation">{</span>
    <span class="token string">&quot;properties&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
        <span class="token string">&quot;name&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
            <span class="token string">&quot;type&quot;</span><span class="token operator">:</span> <span class="token string">&quot;text&quot;</span>
        <span class="token punctuation">}</span><span class="token punctuation">,</span>
        <span class="token string">&quot;description&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
            <span class="token string">&quot;type&quot;</span><span class="token operator">:</span> <span class="token string">&quot;text&quot;</span>
        <span class="token punctuation">}</span><span class="token punctuation">,</span>
        <span class="token string">&quot;price&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
            <span class="token string">&quot;type&quot;</span><span class="token operator">:</span> <span class="token string">&quot;long&quot;</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>'
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br></div></div></li> <li><p>更新映射</p> <p>映射创建成功之后，已有字段不允许更新，可以添加新字段。</p></li> <li><p>删除映射</p> <p>通过删除索引来删除映射。</p></li></ol> <h2 id="三、文档-documents"><a href="#三、文档-documents" class="header-anchor">#</a> 三、文档（documents）</h2> <p>ES 是面向文档的，搜索和索引数据的最小单位是文档。官方文档基础介绍。</p> <blockquote><p>文档是可以被索引的基本信息单元。例如，您可以为单个客户创建一个文档，为单个产品创建另一个文档，以及为单个订单创建另一个文档。该文档以 JSON（JavaScript Object Notation）表示，这是一种普遍存在的互联网数据交换格式。</p> <p>在索引/类型中，您可以存储任意数量的文档。请注意，尽管文档物理上位于索引中，但文档实际上必须被索引/分配给索引内的类型。</p></blockquote> <p><strong>ES 中的文档类似 MySQL 数据表中的记录</strong>。</p> <p>ES 可以存储数据复杂的数据，而且每个数据还存在索引，便于搜索文档内容。）（关系型数据库存储数据结构复杂的数据时，先要打散数据存入数据库，再取出的时候往往需要拼接数据）</p> <h3 id="常用-api-2"><a href="#常用-api-2" class="header-anchor">#</a> 常用 API</h3> <ol><li><p>创建文档</p> <p>不指定Id的话，es 会自动创建 Id。</p> <div class="language-java line-numbers-mode"><pre class="language-java"><code>POST http<span class="token operator">:</span><span class="token operator">/</span><span class="token operator">/</span>localhost<span class="token operator">:</span><span class="token number">9200</span><span class="token operator">/</span><span class="token punctuation">{</span>索引名<span class="token punctuation">}</span><span class="token operator">/</span>_doc<span class="token operator">/</span><span class="token punctuation">{</span>id<span class="token punctuation">}</span>

curl <span class="token operator">--</span>location <span class="token operator">--</span>request POST <span class="token string">'http://localhost:9200/course/_doc'</span> \
<span class="token operator">--</span>header <span class="token string">'Content-Type: application/json'</span> \
<span class="token operator">--</span>data<span class="token operator">-</span>raw '<span class="token punctuation">{</span>
    <span class="token string">&quot;name&quot;</span><span class="token operator">:</span><span class="token string">&quot;Java进阶&quot;</span><span class="token punctuation">,</span>
    <span class="token string">&quot;price&quot;</span><span class="token operator">:</span><span class="token number">120</span><span class="token punctuation">,</span>
    <span class="token string">&quot;description&quot;</span><span class="token operator">:</span><span class="token string">&quot;Java yyds&quot;</span>
<span class="token punctuation">}</span>'
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br></div></div></li> <li><p>更新文档</p> <div class="language-java line-numbers-mode"><pre class="language-java"><code>POST http<span class="token operator">:</span><span class="token operator">/</span><span class="token operator">/</span>localhost<span class="token operator">:</span><span class="token number">9200</span><span class="token operator">/</span><span class="token punctuation">{</span>索引名<span class="token punctuation">}</span><span class="token operator">/</span>_doc<span class="token operator">/</span><span class="token punctuation">{</span>文档<span class="token class-name">Id</span><span class="token punctuation">}</span>

curl <span class="token operator">--</span>location <span class="token operator">--</span>request POST <span class="token string">'http://localhost:9200/course/_doc/q_PQW3oBBs5dY209hPKx'</span> \
<span class="token operator">--</span>header <span class="token string">'Content-Type: application/json'</span> \
<span class="token operator">--</span>data<span class="token operator">-</span>raw '<span class="token punctuation">{</span>
    <span class="token string">&quot;name&quot;</span><span class="token operator">:</span><span class="token string">&quot;Java进阶&quot;</span><span class="token punctuation">,</span>
    <span class="token string">&quot;price&quot;</span><span class="token operator">:</span><span class="token number">130</span><span class="token punctuation">,</span>
    <span class="token string">&quot;description&quot;</span><span class="token operator">:</span><span class="token string">&quot; updateJava yyds&quot;</span>
<span class="token punctuation">}</span>'
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br></div></div></li> <li><p>删除文档</p> <div class="language-java line-numbers-mode"><pre class="language-java"><code>DELETE http<span class="token operator">:</span><span class="token operator">/</span><span class="token operator">/</span>localhost<span class="token operator">:</span><span class="token number">9200</span><span class="token operator">/</span><span class="token punctuation">{</span>索引名<span class="token punctuation">}</span><span class="token operator">/</span>_doc<span class="token operator">/</span><span class="token punctuation">{</span>文档<span class="token class-name">Id</span><span class="token punctuation">}</span>
curl <span class="token operator">--</span>location <span class="token operator">--</span>request DELETE <span class="token string">'http://localhost:9200/course/_doc/qvPHW3oBBs5dY2098vLu'</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div></li> <li><p>搜索所有文档</p> <div class="language-java line-numbers-mode"><pre class="language-java"><code>GET http<span class="token operator">:</span><span class="token operator">/</span><span class="token operator">/</span>localhost<span class="token operator">:</span><span class="token number">9200</span><span class="token operator">/</span><span class="token punctuation">{</span>索引<span class="token punctuation">}</span><span class="token operator">/</span>_doc<span class="token operator">/</span>_search
curl <span class="token operator">--</span>location <span class="token operator">--</span>request GET <span class="token string">'http://localhost:9200/course/_doc/_search'</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div></li> <li><p>根据文档Id查询文档</p> <div class="language-java line-numbers-mode"><pre class="language-java"><code>GET http<span class="token operator">:</span><span class="token operator">/</span><span class="token operator">/</span>localhost<span class="token operator">:</span><span class="token number">9200</span><span class="token operator">/</span><span class="token punctuation">{</span>索引名<span class="token punctuation">}</span><span class="token operator">/</span>_doc<span class="token operator">/</span><span class="token punctuation">{</span>文档<span class="token class-name">Id</span><span class="token punctuation">}</span>

curl <span class="token operator">--</span>location <span class="token operator">--</span>request GET <span class="token string">'http://localhost:9200/course/_doc/qvPHW3oBBs5dY2098vLu'</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div></li> <li><p>搜索指定参数文档</p> <div class="language-java line-numbers-mode"><pre class="language-java"><code>GET http<span class="token operator">:</span><span class="token operator">/</span><span class="token operator">/</span>localhost<span class="token operator">:</span><span class="token number">9200</span><span class="token operator">/</span><span class="token punctuation">{</span>索引<span class="token punctuation">}</span><span class="token operator">/</span>_doc<span class="token operator">/</span>_search<span class="token operator">?</span>q<span class="token operator">=</span><span class="token punctuation">{</span>参数key<span class="token punctuation">}</span><span class="token operator">:</span><span class="token punctuation">{</span>查询值<span class="token punctuation">}</span>

curl <span class="token operator">--</span>location <span class="token operator">--</span>request GET <span class="token string">'http://localhost:9200/course/_doc/_search?q=name:java'</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div></li></ol> <h2 id="四、数据类型"><a href="#四、数据类型" class="header-anchor">#</a> 四、数据类型</h2> <h3 id="字符串类型"><a href="#字符串类型" class="header-anchor">#</a> 字符串类型</h3> <p><a href="https://www.elastic.co/guide/en/elasticsearch/reference/6.8/text.html" target="_blank" rel="noopener noreferrer">Elasticsearch 指南 [6.8] - 文本数据类型<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></p> <p>字符串 <code>string</code> 可被分为 <code>text</code> 和 <code>keyword</code> 类型。若不为索引指定映射，6.x 版本的 es 会把字符串定义为 <strong>text</strong>类型，并增加一个<strong>keyword</strong>的类型字段。</p> <ol><li>text</li></ol> <p>文本数据类型，该类型下字符串会被分词，并根据字符串内容生成倒排索引，便于查询。主要用于适合分词查询的场景。</p> <ul><li><p>analyzer</p> <p>text类型支持分词，可通过 analyzer 属性指定分词器。</p> <p>比如：指定参数的字段类型为text，设置 IK 分词器的分词模式。</p> <div class="language-java line-numbers-mode"><pre class="language-java"><code><span class="token string">&quot;name&quot;</span><span class="token operator">:</span><span class="token punctuation">{</span>
	<span class="token string">&quot;type&quot;</span><span class="token operator">:</span><span class="token string">&quot;text&quot;</span><span class="token punctuation">,</span>
	<span class="token string">&quot;analyzer&quot;</span><span class="token operator">:</span><span class="token string">&quot;ik_max_word&quot;</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div><p>上边指定在索引（动词）和搜索的时候都进行细粒度分词。单独定义搜索时使用的分词级别可设置<code>search_analyzer</code>属性。</p> <div class="language-java line-numbers-mode"><pre class="language-java"><code><span class="token string">&quot;name&quot;</span><span class="token operator">:</span><span class="token punctuation">{</span>
	<span class="token string">&quot;type&quot;</span><span class="token operator">:</span><span class="token string">&quot;text&quot;</span><span class="token punctuation">,</span>
	<span class="token string">&quot;analyzer&quot;</span><span class="token operator">:</span><span class="token string">&quot;ik_max_word&quot;</span><span class="token punctuation">,</span>
	<span class="token string">&quot;search_analyzer&quot;</span><span class="token operator">:</span><span class="token string">&quot;ik_smart&quot;</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div><p>这里指定在索引的时候使用细粒度分词，在查询的时候使用粗粒度。（可提高查询精度）</p></li> <li><p>index</p> <p>可以通过设置 index 属性指定字段是否索引。</p> <p>默认为 <code>index = true</code>，即都需要索引。设置字段需要索引，字段对应信息才会在索引库生成。</p> <p>当有些字段不需要索引时（图片，邮箱等），就可以通过设置 index 实现。</p> <div class="language-java line-numbers-mode"><pre class="language-java"><code><span class="token string">&quot;pic&quot;</span><span class="token operator">:</span><span class="token punctuation">{</span>
	<span class="token string">&quot;type&quot;</span><span class="token operator">:</span><span class="token string">&quot;text&quot;</span><span class="token punctuation">,</span>
	<span class="token string">&quot;index&quot;</span><span class="token operator">:</span><span class="token boolean">false</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div></li></ul> <ol start="2"><li>keyword</li></ol> <p>关键字数据类型，该类型字符串不会被分词，主要用于准确匹配的字符串。比如身份证号、邮箱地址等。查询的时候只能根据完整字符串查询。</p> <div class="language-java line-numbers-mode"><pre class="language-java"><code><span class="token string">&quot;name&quot;</span><span class="token operator">:</span><span class="token punctuation">{</span>
   <span class="token string">&quot;type&quot;</span><span class="token operator">:</span><span class="token string">&quot;keyword&quot;</span>
  <span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><h3 id="数值类型"><a href="#数值类型" class="header-anchor">#</a> 数值类型</h3> <p><a href="https://www.elastic.co/guide/en/elasticsearch/reference/6.8/number.html#number" target="_blank" rel="noopener noreferrer">Elasticsearch 指南 [6.8] - 数字数据类型<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></p> <p>Elasticsearch 支持以下数字类型。</p> <p><img src="https://cdn.jsdelivr.net/gh/AlbertYang0801/pic-bed@main/img/20210630164104.png" alt=""></p> <ul><li><p>为了提高搜索效率，应尽可能选择范围小的数值类型。</p></li> <li><p>选择浮点数的时候，尽量使用比例因子。</p> <p>比如价格信息，单位为元，将比例因子设置为 100 的话 es 会按照分存储。比如输入价格23.123元，存入 es 中会按照 21134 存储。</p> <div class="language-java line-numbers-mode"><pre class="language-java"><code><span class="token punctuation">{</span>
    <span class="token string">&quot;price&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
        <span class="token string">&quot;type&quot;</span><span class="token operator">:</span> <span class="token string">&quot;scaled_float&quot;</span><span class="token punctuation">,</span>
        <span class="token string">&quot;scaling_factor&quot;</span><span class="token operator">:</span> <span class="token number">100</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br></div></div><p>选用比例因子的好处就是比浮点数容易计算，更容易压缩，节省磁盘空间。</p></li></ul> <h3 id="日期类型"><a href="#日期类型" class="header-anchor">#</a> 日期类型</h3> <p><a href="https://www.elastic.co/guide/en/elasticsearch/reference/6.8/date.html" target="_blank" rel="noopener noreferrer">Elasticsearch 指南 [6.8]-日期数据类型<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></p> <p>日期类型不用分词，通常日期类型用于排序等操作。</p> <ul><li><p>format</p> <p>日期格式可以通过 format 自定义，但如果没有<code>format</code>指定，则使用默认值：</p> <div class="language-java line-numbers-mode"><pre class="language-java"><code><span class="token string">&quot;strict_date_optional_time||epoch_millis&quot;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>这意味着它将接受带有可选时间戳的日期，这些时间戳符合<a href="https://www.elastic.co/guide/en/elasticsearch/reference/6.8/mapping-date-format.html#strict-date-time" target="_blank" rel="noopener noreferrer"><code>strict_date_optional_time</code><span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a> 或 纪元以来的毫秒数支持的格式。</p> <p>在设置字段的时候可以通过 format 设置日期格式。</p> <div class="language-java line-numbers-mode"><pre class="language-java"><code><span class="token punctuation">{</span> 
  <span class="token string">&quot;properties&quot;</span><span class="token operator">:</span> 
  	<span class="token punctuation">{</span> 
      <span class="token string">&quot;timestamp&quot;</span><span class="token operator">:</span> 
      	<span class="token punctuation">{</span> 	
          <span class="token string">&quot;type&quot;</span><span class="token operator">:</span> <span class="token string">&quot;date&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;format&quot;</span><span class="token operator">:</span> <span class="token string">&quot;yyyy‐MM‐dd HH:mm:ss||yyyy‐MM‐dd&quot;</span> 
        <span class="token punctuation">}</span> 
    <span class="token punctuation">}</span> 
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br></div></div><p>对应插入文档的参数为：</p> <div class="language-java line-numbers-mode"><pre class="language-java"><code><span class="token punctuation">{</span>
	<span class="token string">&quot;timestamp&quot;</span><span class="token operator">:</span><span class="token string">&quot;2018‐07‐04 18:28:58&quot;</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div></li></ul> <h2 id="五、分词机制"><a href="#五、分词机制" class="header-anchor">#</a> 五、分词机制</h2> <p>IK 分词器默认有两种分词模式，还支持自定义词库。</p> <p>一种是粗粒度分词 <code>ik_smart</code> ，另一种是细粒度分词 <code>ik_max_word</code>。</p> <h3 id="粗粒度分词"><a href="#粗粒度分词" class="header-anchor">#</a> 粗粒度分词</h3> <p>设置 <code>analyzer</code>为<code>ik_smart</code> 会将文本进行<strong>粗粒度</strong>拆分。</p> <p><img src="https://cdn.jsdelivr.net/gh/AlbertYang0801/pic-bed@main/img/20210630164115.png" alt=""></p> <h3 id="细粒度分词"><a href="#细粒度分词" class="header-anchor">#</a> 细粒度分词</h3> <p>设置 <code>analyzer</code>为 <code>ik_max_word</code>会将文本进行<strong>细粒度</strong>拆分。</p> <p><img src="https://cdn.jsdelivr.net/gh/AlbertYang0801/pic-bed@main/img/20210630164115.png" alt=""></p> <h2 id="参考链接"><a href="#参考链接" class="header-anchor">#</a> 参考链接</h2> <ul><li><a href="https://www.elastic.co/guide/en/elasticsearch/reference/6.8/index.html" target="_blank" rel="noopener noreferrer">Elasticsearch Guide<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li> <li><a href="https://blog.csdn.net/Cobbyer/article/details/109814110" target="_blank" rel="noopener noreferrer">ES五| Elasticsearch的映射(字段类型)和分析<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li></ul></div> <footer class="page-edit"><!----> <div class="last-updated"><span class="prefix">上次更新:</span> <span class="time">2021-07-06 22:45:08</span></div></footer> <div class="page-nav"><p class="inner"><span class="prev">
      ←
      <a href="/blog/middleware/es/Elasticsearch环境安装.html" class="prev">
        环境安装
      </a></span> <span class="next"><a href="/blog/middleware/es/Elasticsearch检索.html">
        Elasticsearch检索
      </a>
      →
    </span></p></div> </main></div><div class="global-ui"><!----></div></div>
    <script src="/blog/assets/js/app.b7b681ef.js" defer></script><script src="/blog/assets/js/2.7ded94f8.js" defer></script><script src="/blog/assets/js/77.bdabe94a.js" defer></script>
  </body>
</html>
